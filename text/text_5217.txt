BACKGROUND
a number of unsupervised quasispecies spectrum reconstruction  methods such as shorah  <cit> , qure  <cit> , predicthaplo  <cit> , vispa  <cit>  and quasirecomb  <cit>  are available in literature. comprehensive reviews on these methods are presented in  <cit>  and  <cit> . we recently formulated a novel unsupervised method named viquas  <cit>  for qsr and showed that it outperforms aforementioned popularly used methods.

a major observation on the qsr methods viquas and shorah was that the precision  of reconstructed spectra was less than the recall rate  owing to the reconstruction of in silico false positives. however, we observed in  <cit>  that viquas has the best recall rates among the four methods viquas, shorah, predicthaplo and qure. also, shorah performs at comparable levels with predicthaplo in terms of recall. furthermore, both qure and predic-thaplo demonstrate higher precision values than the corresponding recall values. therefore, we realize that the f-score  values of the spectra reconstructed by viquas and shorah can be improved by controlling the generation of false positives without compromising the recall rates, but such an improvement cannot be achieved in qure and predicthaplo as the spectra generated by them usually contain a lower number of strains than the actual number of strains in the population. therefore, other algorithmic changes will be needed to improve the f-score values of spectra generated by qure and predicthaplo without compromising the recall rates. in this paper, we present a novel probabilistic method to estimate the number of strains in a viral quasispecies population and a strategy to improve the precision and f-score of viquas analysis pipeline without compromising the recall rates, by reducing the number of in silico false positives using above estimates as input information. we also show that the same strategy can be used to improve the performance of shorah.

the number of different microbial types in a mixed population is termed as richness. thus far we find two popular methods of estimating the richness of a mixed microbial population named phaccs  <cit>  and catchall  <cit> . the input to both methods takes the same form. in fact, the input is the contig spectrum of the metagenome derived from the target mixed microbial population. both methods rely on probabilistic parameter estimation strategies. a major assumption regarding the input is that the reads in each contig correspond to only one of the microbial genomes in the population  <cit> ,  <cit> . in other words, it is assumed that the different microbes in the population do not comprise of significant common genomic regions. this assumption is acceptable for populations such as soil, lake water, sea water bacterial populations and bacteriophages, but it is unacceptable for quasispecies populations where the viral strains are highly genetically related. hence, the requirement arises to formulate the richness estimation problem for viral quasispecies in an alternative framework.

the main contributions of this work are two fold. 1) we formulate a novel probabilistic method to estimate the strain richness of a viral quasispecies population and 2) we propose a reconfiguration for the recently published pipeline viquas  <cit> , that significantly improves the precision of reconstructed quasispecies spectra without compromising the recall rate. furthermore, we discuss how the existing quasispecies spectrum reconstruction method shorah  <cit>  can benefit from the proposed estimation strategy.

methods
strain richness estimation
in this work we formulate the strain richness estimation problem as a parameter estimation task given a single observation from a discrete probability distribution.

consider the instance where the biological sample for next-generation sequencing is collected, at which the quasispecies spectrum can be safely assumed as static. let us assume the following notations to formulate the proposed estimation problem.

• l = length of the genomic segment of the known reference  genome of the quasispecies population we are interested in reconstructing.

• s = number of different strains in the quasispecies population.

• ri = number of mutations in the ith strain with respect to the reference genome where i ∈ { <dig>   <dig>   <dig>  ..., s}.

• n = number of total possible mutations that can occur in a single strain.

• r=∑i=1sris 

• u = the random variable defining the number of unique mutations in the population.

it should be noted that two distinct strains can have one or more common mutations, but not all mutations can be common. for the formulation we assume that each strain contains a constant number of mutations with respect to the reference genome. we use the value r as the number of mutations in each strain and define the probability mass function  of u under the parameters s, n and r ) as in equation  <dig> 

  pr=1ifs=1andu=r ∑x=0rpr.psifs∈]0otherwise 

where n, r, u, s∈ℤ+ and x∈ℕ <dig> and equation  <dig> defines ps .

  ps=ur-nr-ifx=0u-xr-x⋅n-u+xxnr-ifx∈ 

in real world populations, the number of mutations in each strain may not be a fixed value , but we show in our results that the effect of this variability on the estimation strategy is minimal under practical settings.

proof

case  <dig> : s = 1

s =  <dig> corresponds to a population where there is only one strain. if the number of mutations in this strain is r, all these mutations are unique in the population. hence, when s =  <dig> the random variable u can only take the value u = r. therefore,

pr =  <dig> when s =  <dig> and u = r

pr =  <dig> when s =  <dig> and u ≠ r

case  <dig> : s∈ <dig> nrand u ≤ r

s >  <dig> corresponds to a population where there are more than one strain. if the number of mutations per strain is r, the first strain contributes r number of unique mutations towards the value of u . the second strain cannot have the same r mutations that are observed in the first strain. therefore, the second strain contains at least one mutation which is different from the already observed r mutations. consequently, when s > <dig>  u takes a value greater than r. also the total number of strains that are possible to be present is nr.

therefore,

pr =  <dig> when s∈ <dig> nr and u ≤ r

case  <dig> : s∈ <dig> nrand u > min

under any circumstance, the number of unique mutations cannot be greater than the number of total possible mutations that can occur in a single strain . consequently, the number of unique mutations in the entire population cannot grow beyond n.

furthermore, when s∈ <dig> nr, the first strain contributes r number of unique mutations towards the value of u and the maximum number any subsequent strain can contribute is also r. hence, the value of u cannot be higher than rs. as a result, when s∈ <dig> nr, the maximum value attainable by u is min. therefore,

pr =  <dig> when s∈ <dig> nr and u > min

case  <dig> : s∈ <dig> nrand u ∈ ]

based on case  <dig> and case  <dig> we understand that, when s∈ <dig> nr, u can get an integer value within the range ].

consider the situation where we have observed u = u - x with . in order to observe u = u with s number of strains, the remaining sth strain should contain exactly x number of new unique mutations. x can be any natural number in the range . hence, the probability of observing u = u with s number of strains is,

 pr= ∑x=0rpr.ps 

where ps  is the probability of observing x  number of new unique mutations in the sth strain.

consider the case where x ∈ . for the sth strain to contain exactly x number of new unique mutations out of a total of r, only  number of mutations in the sth strain can be a subset of the already observed  number of unique mutations. the remaining x number of mutations should arise from the unobserved n -  possible mutations. in addition, the total number of ways that these r mutations can occur without being equivalent to one of the  number of already observed ways is nr-.

hence, when x ∈ ,

 ps=u-xr-x⋅n-u+xxnr- 

consider the case where x =  <dig>  in this case all r mutations of the sth strain must come from the already observed u unique mutations in the  number of strains. however, the sth strain cannot be equivalent to any of the already observed  strains. the number of ways this scenario can occur is ur-. similar to the case where x ∈ , the total number of ways that these r mutations can occur without being equivalent to one of the  number of already observed ways is nr-

hence, when x =  <dig> 

 ps=ur-nr- 

we observe that for all u = u where u ∈ [r, n), there exist a global optimum value in the likelihood function of s given u ) such that s is finite. hence, given an observed value for u we can readily use the maximum likelihood strategy to estimate the value of s. a closed form equation for the maximum likelihood estimator of s  cannot be derived. nevertheless, smle can be obtained numerically in a time efficient manner using dynamic programming.

the expected value of u given the value of s ) is a strictly increasing discrete valued function of s for given values of n and r. therefore, as a second strategy we can estimate s using the method of moments.

in real world quasispecies populations, we can assume that r, s <<<n. since it is impractical to know the value of n, we set n = l. this approximation is observed to have minimal effect on the parameter estimators when r, s <<<l .

calculating r given a ngs metagenome
for a given metagenome the chance of each strain being completely sequenced, decreases with its relative frequency.  <cit>  extends the lander-waterman model of sequencing  <cit>  to derive the probability that all the strains are covered by the given number of sequenced reads assuming the reads are uniformly distributed along the genomic region of interest. the theoretically re-constructible minimum relative frequency , derived according to  <cit>  and  <cit> , defines a relative frequency value for the strains in the population above which the probability of a strain being completely covered is at least pmin. we set pmin =  <dig>  in our study.

given a ngs metagenome, we use viquas algorithm presented in  <cit>  to reconstruct the unsupervised quasispecies spectrum of the viral population. we demonstrated in  <cit>  that viquas reconstructs a highly reliable spectrum for strains having a relative frequency greater than the theoretically re-constructible minimum relative frequency . hence we obtain an approximate value for r by calculating the median number of mutations present in the reconstructed strains having a relative frequency greater than fmin.

alternatively, if we can safely assume that the sequenced reads provide a uniform coverage across the genomic region of interest, following formulae can be used to calculate the parameter r.

  coverage=totalnumberofsequencedbasesalignedwithinthegenomicregionlengthofthegenomicregion 

  r=totalnumberofmutationsinreadsalignedwithinthegenomicregioncoverage 

calculating u given a ngs metagenome
depending on the information we are interested in, we use different strategies to calculate u . let us denote st as the total number of strains in the population  and sf as the number of strains having a relative frequency greater than fmin.

each read in the metagenome carries zero or more mutations belonging to a single strain of the original population. however, it is unlikely that all the mutations carried by the strains having a relative frequency less than fmin are captured during sequencing. hence, defining u as the number of unique mutations captured in all reads of the metagenome leads us to an estimate of s less than st .

as a second strategy, we define u as the number of unique mutations captured in the local haplotypes of the viquas analysis pipeline having a local haplotype frequency greater than fmin. due to the presence of common genomic regions, reads originating from two or more low frequency strains can form a single local haplotype having a local haplotype frequency greater than fmin. therefore, the second strategy gives us a u value corresponding to a number of strains slightly higher than sf. hence, the estimated value  is an upper bound for sf.

reconfiguration of viquas
the viquas analysis pipeline presented in  <cit>  performs an unsupervised reconstruction of strains given a ngs read set. we propose to reconfigure the original viquas pipeline as follows. first, the unsupervised algorithm provides information needed to calculate the parameter r and the observation u as outlined in the previous subsections, facilitating the calculation of ŝf. this ŝf value is fed back to the global spectrum reconstruction algorithm of viquas to decide whether it should continue with the unsupervised result or terminate after having reconstructed ŝf number of strains. assume the unsupervised viquas pipeline has reconstructed sf,u number of strains with a frequency greater than fmin. then,

if, sf,u>ŝf⇒ terminate after ŝf strains else, continue with the unsupervised result

data sets
for the ease of comprehension and comparison of results, we used the simulated data sets  described in detail in  <cit>  to benchmark the viquas and shorah using the proposed reconfigurations presented in this paper.  we also used the v <dig> real roche  <dig> hiv- <dig> data set to demonstrate the applicability of the estimation strategy on real data. details of v <dig> are provided in  <cit> .

RESULTS
validation of strain richness estimation theory
we used  <dig> simulated quasispecies populations with known input parameters to validate the strain richness estimation theory for practical settings where the number of mutations per strain and the number of strains are much less than the target genome length . the simulated samples have the following parameter spaces: n =  <dig>  r ∈ { <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  50} and s ∈ { <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  100}. apart from the three parameters mentioned in strain richness estimation subsection, we used the parameter v ∈ { <dig>   <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> } to model the variability of r within a given population. for example, each simulated population has s number of strains and the distribution of the number of mutations in each strain has a discrete normal distribution with mean r and standard deviation vr.

  absolutepercentageerror=|estimatedvalue-truevalue|*100%truevalue 

we observed that the estimation errors of both parameters decrease with increasing diversity  and increase with increasing st. furthermore, we observe that the estimation errors of st are predominantly negative  and that of sf are predominantly positive  and the magnitudes of median error are close to zero. the major causes of positive estimation error of st are:  significant difference between the calculated r and the actual r used in simulating data and  the existence of samples where st≃sf. the major cause of negative estimation error of st is the significant difference between the calculated r and the actual value. this confirms our claim in calculating u given a ngs metagenome subsection that the corresponding estimates  give a lower bound for st and an upper bound for sf.

enhanced qsr performance in viquas and shorah
in our previous work  <cit>  we observed that the precision of reconstructed quasispecies spectra are significantly lower than the recall rate under all simulation settings due to the reconstruction of a significantly higher number of false positive strains. using the estimated value ŝf as an upper bound for sf we controlled the growth of false positive strains and obtained significant gain in precision  as shown in figure  <dig>  consequently we also observed significant gain in f-score values  for reconstructed spectra using viquas . 

furthermore, we applied the same reconfiguration we proposed on vi-quas using the estimated upper bounds for sf  on an existing qsr methods named shorah to evaluate the performance enhancement attainable via our new estimation strategy. table  <dig> summarizes the gain in precision and f-score attained by the two methods, viquas and shorah. similar to viquas, we observe that shorah also attains considerable gain in precision and f-score when the added knowledge of ŝf values is used. most importantly, no compromise in recall rates were observed associated with the gain in precision of both viquas and shorah.  the three performance measurement terms recall, precision and f-score were calculated according to the following equations. further details regarding the calculations are found in  <cit> .

  recall=truepositivestrainswitharelativefrequency>fminexpectednumberofstrains  

  precision=truepositivestrainswitharelativefrequency>fmintotalnumberofreconstructedstrainswitharelativefrequency>fmin 

  f - score=2× 

application on real data
analyzing v <dig>  <cit>  using the estimation method we found that it contains  <dig> mutations per strain on average  within the  <dig> bp long region of interest. the diversity, number of strains, exact nucleotide sequences and the relative frequencies of the strains in the population are unknown. the estimated technical error rate of this sample is  <dig> %  <cit> , mean read length is 90bp and the total number of reads  is  <dig>  the theoretically re-constructible minimum relative frequency  for this set of reads is  <dig> %. the number of unique mutations found in the total set of reads was  <dig> and the number of unique mutations found in the local haplotypes having a relative frequency greater than fmin was  <dig>  accordingly, our method estimated that ŝt= <dig> and ŝf= <dig> for v <dig> hiv- <dig> data set using the p.d.f. pr.

discussion and 
CONCLUSIONS
to the best of our knowledge there exists no dedicated method in literature to estimate the number of strains in a viral quasispecies population. our previous studies highlighted that the unsupervised quasispecies spectrum reconstruction methods such as shorah  <cit>  and qure  <cit>  reconstruct respectively higher and lower number of in silico false positive strains. these methods were not aimed at providing accurate estimates for the number of strains in a population. estimation of species richness in mixed microbial populations is a problem that is closely related to the problem discussed here. however, methods addressing mixed microbial population richness estimation are not applicable to the problem at hand due to the characteristic differences between the subjective populations. we presented in this paper a novel probabilistic method to estimate the number of strains in a quasispecies population based on the distribution of mutations among different strains.

the derived p.m.f. pr shows a significant relationship to the well known hypergeometric distribution. we were unable to derive closed form expressions for the maximum likelihood and method of moments estimators for the parameter s. they were calculated using dynamic programming as both estimators are deterministic. we chose to use the method of moments estimator as it provided marginally better estimates than the maximum likelihood estimator on benchmark data sets.

we demonstrated that the variability in the number of mutations per strains in a population has minimal effect on the estimation method under practical parameter values of n, r and s. however, the estimates are considerably sensitive to the parameter r. this implies that identifying the location of the distribution  of the number of mutations per strain is a critical step in the presented method. accordingly, we identified that significant differences between the calculated and correct r values as the main cause of the outliers  of the error plots in figures  <dig> and  <dig> 

using the estimated upper bound of sf , we reconfigured the vi-quas analysis pipeline to control the growth of in silico false positives. the summarized results presented in figures  <dig>   <dig> andtable  <dig> show that the reconfigured viquas pipeline improves the precision and f-score of reconstructed spectra compared to the previously proposed viquas pipeline  <cit> . the highlight of the proposed reconfiguration is that we use the knowledge from both the unsupervised algorithm and the probabilistic estimation method to make a well informed decision to limit the number of false positives. this strategy allows the reconfigured viquas pipeline to compensate for errors introduced by:  the uncontrolled growth of strains when using the unsupervised algorithm alone and  the sensitivity of the estimation method to calculation errors of the parameter r.

we also demonstrated that, similar to viquas, the performance of the existing method shorah can be substantially improved using the added knowledge of the estimated ŝf values. it will be an interesting study to see whether qure and predicthaplo can be improved by giving the estimated ŝf values as input to the global spectrum reconstruction stage of the algorithms. this will require the ability to edit the source code of the respective methods. also, the reconfiguration proposed in this paper can be used to reduce the computational cost to a certain extent by appropriately reducing the number of strains being reconstructed in the global strain reconstruction stage of a quasispecies spectrum reconstruction pipeline.

although the method can handle an error rate of  <dig> % , we identify the absence of a proper discounting method to overcome the effect of technical sequencing errors  when calculating different parameters of the estimation method as the main drawback of our proposal. we plan to study further on such a discounting strategy that can overcome both substitutional and homopolymeric errors.

we also plan to study further on the p.m.f. with the view of improving the efficiency of the calculation methods and providing sound mathematical proof for the observed properties of the parameter estimators. we hope this new probability distribution will be useful in many theoretical and applied statistical problems in the future.

in addition to modeling the distribution of mutations as proposed in this paper, a quasispecies population may also be modeled using master equations  <cit>  to estimate the strain richness. however, solving highly complex master equations has been a main bottleneck for decades  <cit>  when using such techniques.

competing interests
the authors declare that they have no competing interests.

authors' contributions
dj formulated the problem and the statistical solution, carried out the simulations, analyzed real data and wrote the manuscript. is and skh contributed in formulating the statistical solution, designing the validation and simulation studies and preparing the manuscript. bcc and slt contributed in designing the simulation study, analyzing real data and preparing the manuscript.

supplementary material
additional file 1
description of simulated data sets. detailed description of the simulated data sets ss1-ss <dig> 

click here for file

 acknowledgements
we would like to thank professor ian gordon of the statistical consulting centre  of the department of mathematics and statistics, the university of melbourne for helping to validate the statistical formulations. we also thank dr. tharaka samarasinghe, senior lecturer at the university of moratuwa, sri lanka and mr. thilina buddhika, phd candidate at the computer science department, colorado state university, usa for their help in formulating the method. this work is partially funded by australia research council  and by mifrs and mirs scholarships of the university of melbourne .

declarations
publication charges for this article have been funded by the university of melbourne.

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2015: joint 26th genome informatics workshop and 14th international conference on bioinformatics: bioinformatics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements/16/s <dig> 
