BACKGROUND
horizontal gene transfer  is a process that results in the acquisition of novel genes originating from perhaps taxonomically unrelated species. this phenomenon is frequent among microbes and is considered a means of rapid adaptation to changing environmental demands  <cit> . pieces of dna acquired via hgt frequently have a considerable length. these patches have been called genomic islands  or due to their role and more specifically pathogenicity islands  <cit>  or symbiotic islands  <cit> .

several methods have been developed for the prediction of gis based on different approaches to identify putatively alien  genes  <cit> . each of these concepts has specific preferences and drawbacks; for recent reviews see  <cit> . in the following, we describe an approach which relies on the genome theory postulating a rather homogeneous codon usage within a genome  <cit> . the algorithm exploits taxon specific differences in codon usage for the identification of pa genes and the prediction of their putative origin. hidden markov models  are a state of the art concept in computational learning theory. a sequence of observations is considered as being emitted from the states of an invisible markov chain. the viterbi algorithm efficiently computes a sequence of states that have the maximal posteriori probability given a certain sequence of observations and fixed transition and emission probabilities. the challenge in designing a hmm is representing the real situation adequately in order to generate relevant predictions. hmm have proved useful in many applications. in the case of predicting eukaryotic genes, for example, the programs genscan  <cit> , hmmgene  <cit> , genomescan  <cit> , augustus  <cit> , and augustus+  <cit>  are hmm-based.

it has been shown that hmms allow to predict gis  <cit> . gis have typically a considerable length, therefore we have decided to implement a hmm assessing gi prediction on the gene level. gis can originate from a variety of a priori unknown donors. therefore, it is difficult to assure sufficient test statistics. we will describe an approach named sigi-hmm. to some extent, it is based on principles introduced with sigi  <cit> . this program was used to analyze individual genomes  <cit>  and to study the content of genomic islands in general  <cit>  as well as to characterize gene-flux between bacteria and archaea  <cit> . for sigi-hmm we substituted a heuristic approach with a hmm. sigi-hmm has only few parameters to adjust. the most relevant one is a sensitivity controller which affects transitions of the hmm in a consistent manner. we will demonstrate and assess the performance of sigi-hmm by analyzing genomes in detail.

implementation
we have implemented sigi-hmm in java as a first module of our software suite colombo intended as a workbench for the statistical analysis of genomic data. the program can be downloaded from  <cit> . the download package contains also the program artemis  <cit> , which is used to visualize the output of sigi-hmm. after the installation, a genomic dataset formatted in embl-format can be loaded and analyzed. sigi-hmm creates several lists containing the predictions in gff-format or tabulated. predictions are classified according to the categories native and putal. in addition, a modified embl-formatted file is generated containing both the original annotation and the predictions. this file can be fed into artemis in order to color-code and visualize genome content. thus, the user can interactively study the composition of genomes. intentionally, only few parameters can be manipulated by the user: the sensitivity controller and the gap length which decides on merging single gis to larger ones. in addition, the user can supplement the list of putative donors we have deduced from the cutg database . the default value of the the sensitivity controller was chosen to give predictions consistent with published results; see table  <dig>  if it is known that the genome under study contains gis, we propose the following approach in order to optimize sensitivity of sigi-hmm: starting from a low value, sensitivity should be increased until all known gis appear. if new islands emerge, they show the same degree of codon usage bias and should be considered gis.

RESULTS
the following text is organized as follows: first we introduce data models, the scoring system and the architecture of the hmm. then we evaluate the predictive power of the algorithm and present analyses of several genomes.

stochastic data models
let g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ be a series of genes as deduced from a genome coding for proteins  . for each codon c we count its occurrence #c in g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@. we define the synonymous frequency qac ∈  <cit>  as the ratio of #c divided by the occurrence of the amino acid a encoded by c in  . the frequency qc ∈  <cit>  of c in g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ is defined as #c divided by the occurrence of all codons in  .

now let g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig> be a prokaryotic genome whose genomic islands have to be predicted and let g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig>  g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig>  ..., g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@r be genomes assumed to be the donors for pa genes occurring in g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig>  we consider g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig> to g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@r as representatives of taxa t
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwftepvaaa@3847@ <dig> to t
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwftepvaaa@3847@r which are assumed to be the putative sources of g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@0's alien genes. for each protein  π = a <dig>  a <dig> ..., an that is encoded by a gene g of genome g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig> , and for each ρ =  <dig>   <dig>  ..., r, we define the probability

pρ:=qa1c1⋅qa2c2⋅...⋅qancn,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudawgaawcbaaccigae8xwdihabeaakiabcicaoiabdeganjabcyha8jab=b8awjabcmcapiabcqda6iabg2da9iabdghaxnaadaaaleaacqwghbqydawgaaadbagaegymaedabeaaliabdogajnaabaaameaacqaixaqmaeqaaawcbagaeiikagiae8xwdinaeiykakcaaogaeyyxictaemycae3aa0baasqaaiabdggahnaabaaameaacqaiyagmaeqaasgaem4yam2aasbaawqaaiabikdayaqabaaaleaacqggoaakcqwfbpgccqggpaqkaagccqghfly1cqgguaglcqgguaglcqgguaglcqghfly1cqwgxbqcdaqhaawcbagaemyyae2aasbaawqaaiabd6gaubqabawccqwgjbwydawgaaadbagaemoba4gabeaaasqaaiabcicaoiab=f8ayjabcmcapaaakiabcycasiaaxmaacawljawaaewaaeaacqaixaqmaiaawicacaglpaaaaaa@6515@

where qac
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgxbqcdaqhaawcbagaemyyaemaem4yamgabagaeiikagcccigae8xwdinaeiykakcaaaaa@3457@ ∈  <cit>  is the synonymous frequency in genome g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ρ as defined above.

scoring scheme
we utilize the odds ratio

p0pρ=qa1c1⋅qa2c2⋅...⋅qancnqa1c1⋅qa2c2⋅...⋅qancn
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabdcfaqnaabaaaleaacqaiwaamaeqaaogaeiikagiaem4zacmaeiifawhccigae8hwdanaeiykakcabagaemiuaa1aasbaasqaaiab=f8aybqabagccqggoaakcqwgnbwzcqgg8bafcqwfapaccqggpaqkaagaeyypa0zaasaaaeaacqwgxbqcdaqhaawcbagaemyyae2aasbaawqaaiabigdaxaqabawccqwgjbwydawgaaadbagaegymaedabeaaasqaaiabcicaoiabicdawiabcmcapaaakiabgwsixlabdghaxnaadaaaleaacqwghbqydawgaaadbagaegomaidabeaaliabdogajnaabaaameaacqaiyagmaeqaaawcbagaeiikagiaegimaajaeiykakcaaogaeyyxictaeiola4iaeiola4iaeiola4iaeyyxictaemycae3aa0baasqaaiabdggahnaabaaameaacqwgubgbaeqaasgaem4yam2aasbaawqaaiabd6gaubqabaaaleaacqggoaakcqaiwaamcqggpaqkaaaakeaacqwgxbqcdaqhaawcbagaemyyae2aasbaawqaaiabigdaxaqabawccqwgjbwydawgaaadbagaegymaedabeaaasqaaiabcicaoiab=f8ayjabcmcapaaakiabgwsixlabdghaxnaadaaaleaacqwghbqydawgaaadbagaegomaidabeaaliabdogajnaabaaameaacqaiyagmaeqaaawcbagaeiikagiae8xwdinaeiykakcaaogaeyyxictaeiola4iaeiola4iaeiola4iaeyyxictaemycae3aa0baasqaaiabdggahnaabaaameaacqwgubgbaeqaasgaem4yam2aasbaawqaaiabd6gaubqabaaaleaacqggoaakcqwfbpgccqggpaqkaaaaaaaa@8e1c@

in the following way as a scoring scheme. the codon usage of g originating from g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig> resembles more the prevalences of g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ρ if

τρ,α>p0pρ.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfepaddawgaawcbagae8xwdinaeiilawiae8xsdegabeaakiabg6da+maalaaabagaemiuaa1aasbaasqaaiabicdawaqabagccqggoaakcqwgnbwzcqgg8bafcqwfapaccqggpaqkaeaacqwgqbaudawgaawcbagae8xwdihabeaakiabcicaoiabdeganjabcyha8jab=b8awjabcmcapaaacqgguaglcawljagaaczcamaabmaabagaegomaidacagloagaayzkaaaaaa@4a87@

if this is the case for some ρ and if

ρ*=arg⁡min⁡ρ∈{ <dig> ,...,r}p0pρ,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfbpgccqggqagkcqgh9aqpdawfqaqaaigbcggahjabckhayjabceganjgbc2gatjabcmgapjabc6gaubwcbagae8xwdinaeyici4saei4easnaegymaejaeiilawiaegomaijaeiilawiaeiola4iaeiola4iaeiola4iaeiilawiaemocainaeiyfa0habeaakmaalaaabagaemiuaa1aasbaasqaaiabicdawaqabagccqggoaakcqwgnbwzcqgg8bafcqwfapaccqggpaqkaeaacqwgqbaudawgaawcbagae8xwdihabeaakiabcicaoiabdeganjabcyha8jab=b8awjabcmcapaaacqggsaalaaa@5a7b@

then gene g is considered to be pa originating from taxon tρ*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwftepvdawgaawcbaaccigae4xwdinaeiokaocabeaaaaa@3b15@ represented by genome gρ*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=rdawgaawcbaaccigae4xwdinaeiokaocabeaaaaa@3afb@. this principle of deducing the putative donor has previously been introduced and validated  <cit> .

how to choose the thresholds τρ,α needed in equation 2? let ℱπ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfxeirdawgaawcbaaccigae4hwdahabeaaaaa@3976@ be the set of all theoretically possible genes coding for protein π. for each ρ ∈ { <dig>   <dig> ..., r}, we consider the statistic

tρ:=ln⁡p0pρ,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg0baddawgaawcbaaccigae8xwdihabeaakiabcicaoiabdeeahjabcmcapiabcqda6iabg2da9igbcygasjabc6gaunaalaaabagaemiuaa1aasbaasqaaiabicdawaqabagccqggoaakcqwghbwrcqgg8bafcqwfapaccqggpaqkaeaacqwgqbaudawgaawcbagae8xwdihabeaakiabcicaoiabdeeahjabcyha8jab=b8awjabcmcapaaacqggsaalaaa@4a04@

where g ∈ ℱπ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfxeirdawgaawcbaaccigae4hwdahabeaaaaa@3976@ is a random element distributed according to pρ . having computed the mean μρ and the standard deviation σρ of tρ, we apply the central limit theorem: the random variable 1/σρ - μρ) is approximately distributed according to the standard normal distribution with the cumulative distribution function Φ. we determine the value τρ, α such that

α=1−Φ.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfxoqycqgh9aqpcqaixaqmcqghsislcqqhmogrdaqadaqaamaalaaabagagiibawmaeioba4mae8hxdq3aasbaasqaaiab=f8ayjabcycasiab=f7ahbqabagccqghsislcqwf8oqbdawgaawcbagae8xwdihabeaaaoqaaiab=n8aznaabaaaleaacqwfbpgcaeqaaaaaaogaayjkaiaawmcaaiabc6cauaaa@465b@

the parameter α serves as sigi-hmm's sensitivity controller. it can be adjusted by the user. please note that the impact of parameter α onto the decision is independent of g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig> and g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ρ.

eliminating putatively highly expressed genes
in several genomes, highly expressed genes show a specific codon usage which deviates from the average one and resembles codon prevalences observed in genes coding for ribosomal proteins; see e.g.  <cit> . we name these genes putatively highly expressed . on the one hand, it is unlikely that these genes were acquired via hgt. on the other hand, methods based on codon usage tend to classify them as pa. this needs to be prevented explicitly. we use an approach similar to the gcb score introduced in  <cit> . it was shown that this methods is one of the best to predict gene expressivity  <cit> . let qac
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgxbqcdaqhaawcbagaemyyaemaem4yamgabagaeiikagiaegimaajaeiilawiaeeocainaeeyaakmaeeoyaimaeiykakcaaaaa@386d@ be the synonymous codon frequencies for the ribosomal genes of genome g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig> and let

p <dig> rib:=qa1c1⋅qa2c2⋅...⋅qa3c <dig>      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudawgaawcbagaegimaajaeiilawiaeeocainaeeyaakmaeeoyaigabeaakiabcicaoiabdeganjabcyha8hgaciab=b8awjabcmcapiabcqda6iabg2da9iabdghaxnaadaaaleaacqwghbqydawgaaadbagaegymaedabeaaliabdogajnaabaaameaacqaixaqmaeqaaawcbagaeiikagiaegimaajaeiilawiaeeocainaeeyaakmaeeoyaimaeiykakcaaogaeyyxictaemycae3aa0baasqaaiabdggahnaabaaameaacqaiyagmaeqaasgaem4yam2aasbaawqaaiabikdayaqabaaaleaacqggoaakcqaiwaamcqggsaalcqqgybgccqqgpbqacqqgibgycqggpaqkaagccqghfly1cqgguaglcqgguaglcqgguaglcqghfly1cqwgxbqcdaqhaawcbagaemyyae2aasbaawqaaiabiodazaqabawccqwgjbwydawgaaadbagaeg4mamdabeaaasqaaiabcicaoiabicdawiabcycasiabbkhayjabbmgapjabbkgaijabcmcapaaakiabc6cauiaaxmaacawljawaaewaaeaacqaizawmaiaawicacaglpaaaaaa@74c3@

if

trib:=ln⁡p <dig> ribpρ>θ,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg0baddawgaawcbagaeeocainaeeyaakmaeeoyaigabeaakiabcicaoiabdeganjabcmcapiabcqda6iabg2da9igbcygasjabc6gaunaalaaabagaemiuaa1aasbaasqaaiabicdawiabcycasiabbkhayjabbmgapjabbkgaibqabagccqggoaakcqwgnbwzcqgg8bafiigacqwfapaccqggpaqkaeaacqwgqbaudawgaawcbagae8xwdihabeaakiabcicaoiabdeganjabcyha8jab=b8awjabcmcapaaacqgh+agpcqwf4oqccqggsaalaaa@54c0@

we consider the gene g as not alien .

the threshold θ is determined as follows: let μ <dig> and μ <dig> rib be the mean values and σ <dig> and σ <dig> rib be the standard deviations of the test statistic trib, where g is distributed according to p <dig> and p <dig> rib, respectively. the distribution functions of 1/σ <dig> - μ0) and 1/σ <dig> rib - μ <dig> rib) are approximately standard normal. we choose θ in such a way that

1−Φ=Φ.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqaixaqmcqghsislcqqhmogrdaqadaqaamaalaaabaaccigae8hudenaeyoei0iae8hvd02aasbaasqaaiabicdawaqabaaakeaacqwfdpwcdawgaawcbagaegimaadabeaaaaaakiaawicacaglpaaacqgh9aqpcqqhmogrdaqadaqaamaalaaabagae8hudenaeyoei0iae8hvd02aasbaasqaaiabicdawiabcycasiabbkhayjabbmgapjabbkgaibqabaaakeaacqwfdpwcdawgaawcbagaegimaajaeiilawiaeeocainaeeyaakmaeeoyaigabeaaaaaakiaawicacaglpaaacqgguaglcawljagaaczcamaabmaabagaeginaqdacagloagaayzkaaaaaa@54f0@

thus, the error of the first and second kind are of equal size.

architecture of the hmm mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwftepvaaa@3847@ <dig> to t
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwftepvaaa@3847@r. gis frequently have a mosaic structure which is due to their generation in a multistep process . therefore, we allow transitions from any putal  state to any other one.

in order to implement our sensitivity controller, we let the transition probabilities depend on the protein under consideration. thus, the markov chain presented in figure  <dig> is in fact an inhomogeneous one driven by the series   <dig> of proteins encoded by g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig>  to simplify notation, we have omitted the index π, which refers to the protein. instead, we identify a protein by its index originating from   <dig> 

solving some linear equations, the transition probabilities given in figure  <dig> can be determined in such a way that

a⋅τρ,α=pgi2gi,ρpgi2naandb⋅τρ,α=pna2gi,ρpna2na.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeqadaaabagaemyyaemaeyyxicnccigae8hxdq3aasbaasqaaiab=f8ayjabcycasiab=f7ahbqabagccqgh9aqpdawcaaqaaiabdchawnaabaaaleaacqqgnbwzcqqgpbqacqqgyagmcqqgnbwzcqqgpbqacqggsaalcqwfbpgcaeqaaagcbagaemicaa3aasbaasqaaiabbeganjabbmgapjabbkdayiabb6gaujabbggahbqabaaaaagcbagaeeyyaemaeeoba4maeeizaqgabagaemoyaimaeyyxictae8hxdq3aasbaasqaaiab=f8ayjabcycasiab=f7ahbqabagccqgh9aqpdawcaaqaaiabdchawnaabaaaleaacqqgubgbcqqghbqycqqgyagmcqqgnbwzcqqgpbqacqggsaalcqwfbpgcaeqaaagcbagaemicaa3aasbaasqaaiabb6gaujabbggahjabbkdayiabb6gaujabbggahbqabaaaaaaakiabc6cauaaa@6c1a@

a and b are positive constants which were chosen appropriately to generate gis which are at mean shorter than the surrounding regions of native genes. the probabilities px2y correspond to transitions from state x to y .

we extend the markov chain x <dig>  x <dig>  ..., xℓ driven by the state diagram given in figure  <dig> to a hmm x <dig>  y <dig>  x <dig>  y <dig> ..., xℓ, yℓ in the following way: for π =  <dig>   <dig> .., ℓ, the random emission yπ takes values in the sample space ℱπ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfxeirdawgaawcbaaccigae4hwdahabeaaaaa@3976@ defined above. for ρ =  <dig>   <dig> ..., r, the emission probabilities are defined by means of equation  <dig> as follows:

p = p <dig>     and     p = pρ.     

as already explained, phx genes have to be eliminated. our test for putatively highly expressed genes classifies genes as phx or ¬phx. in order to integrate these predictions into the hmm, we interpret the outputs as a random sequence h <dig>  h <dig> ..., hℓ of hints. please note that an emission is now a combination of a gene and a hint. hints are interpreted the following way: for the native state we define

p={1if trib>θ;0otherwise.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaucqggoaakcqwgibasdawgaawcbaaccigae8hwdahabeaakiabg2da9iabbchawjabbigaojabbiha4jabcyha8jabdifaynaabaaaleaacqwfapacaeqaaogaeyypa0jaeeota4kaeeyqaekaeeivaqlaeeysakkaeeovaylaeeyraukaeiilawiaemywak1aasbaasqaaiab=b8awbqabagccqgh9aqpcqwgnbwzdawgaawcbagae8hwdahabeaakiabcmcapiabg2da9maaceaabaqbaeaabigaaaqaaiabigdaxaqaaiabbmgapjabbagamjaaykw7cqwg0baddawgaawcbagaeeocainaeeyaakmaeeoyaigabeaakiabcicaoiabdegannaabaaaleaacqwfapacaeqaaogaeiykakiaeyopa4jae8hudenaei4oasdabagaegimaadabagaee4ba8maeeidaqnaeeiaagmaeeyzaumaeeocainaee4dacnaeeyaakmaee4camnaeeyzaumaeiola4caaagaay5eaaaaaa@708d@

for ρ =  <dig>   <dig> ..., r, the emission probability given a pa state is defined by

p =  <dig> 

it is biological evidence, which led to the above definitions. the products of highly expressed genes are involved in complex interactions. therefore, it is highly unlikely that these genes can be replaced by hgt. please note that the algorithm has – due to our design – to consider each hint.

determination of the codon-specific core and atypical genes
it might be that some pa genes originate from sources not characterized by our set of putative donors . in order to identify these atypical genes, we determine the codon-specific core  of a genome, which consists of those genes having an unsuspicious codon usage. having chosen a protein π ∈  <dig> and the related gene g ∈ g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig>  we consider a random element g of the set ℱπ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfxeirdawgaawcbaaccigae4hwdahabeaaaaa@3976@ distributed according to p <dig> . for the following test, we identifed those amino acids a encoded by more than one codon and occurring at least  <dig> times  in the protein. for each codon c which encodes amino acid a we introduce a random variable countc = #c, which follows a binomial distribution characterized by the expected value naqac
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubgbdawgaawcbagaemyyaegabeaakiabdghaxnaadaaaleaacqwghbqycqwgjbwyaeaacqggoaakcqaiwaamcqggpaqkaaaaaa@3664@ and variance naqac
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubgbdawgaawcbagaemyyaegabeaakiabdghaxnaadaaaleaacqwghbqycqwgjbwyaeaacqggoaakcqaiwaamcqggpaqkaaaaaa@3664@
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubgbdawgaawcbagaemyyaegabeaakiabdghaxnaadaaaleaacqwghbqycqwgjbwyaeaacqggoaakcqaiwaamcqggpaqkaaaaaa@3664@). the statistic

φ c:=countc−naqacnaqac)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfgpgzdawgaawcbagaagpavlabdogajbqabagccqggoaakcqwghbwrcqggpaqkcqgg6agocqgh9aqpdawcaaqaaiabbogajjabb+gavjabbwha1jabb6gaujabbsha0naabaaaleaacqwgjbwyaeqaaogaeiikagiaem4rackaeiykakiaeyoei0iaemoba42aasbaasqaaiabdggahbqabagccqwgxbqcdaqhaawcbagaemyyaemaem4yamgabagaeiikagiaegimaajaeiykakcaaagcbawaaoaaaeaacqwgubgbdawgaawcbagaemyyaegabeaakiabdghaxnaadaaaleaacqwghbqycqwgjbwyaeaacqggoaakcqaiwaamcqggpaqkaagccqggoaakcqaixaqmcqghsislcqwgxbqcdaqhaawcbagaemyyaemaem4yamgabagaeiikagiaegimaajaeiykakcaaogaeiykakcaleqaaaaaaaa@6091@

is approximately distributed according to the standard normal distribution. for each δ ∈  there is exactly one θδ >  <dig> such that

p|  ≥θδ)=2Φ=δγ,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaucqggoaakcqgg8bafiigacqwfgpgzdawgaawcbagaagpavlabdogajbqabagccqggoaakcqwghbwrcqggpaqkcqgg8bafcaamc8uaagpavlabgwmizkab=h7axnaabaaaleaacqwf0oazaeqaaogaeiykakiaeyypa0jaegomaijaeuopdykaeiikagiaeyoei0iae8hude3aasbaasqaaiab=r7akbqabagccqggpaqkcqgh9aqpdawcaaqaaiab=r7akbqaaiab=n7anbaacqggsaalaaa@5153@

where γ is the occurrence of those amino acids considered in this section. in analogy to  <cit> , we name the gene g δ-typical ), if for all codons c

|φc| <θδ.

this is why the probability of being not δ-typical is for a random gene g less than or equal to δ. setting δ to 10/ℓ, where ℓ is the number of g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@0's genes, turned out to be adequate. only few genes  were labelled as atypical . therefore, the exact value of δ is uncritical. this observation confirms that our selection of codon usage tables covers the prevalences of putative donors to a great extent.

the algorithm for computing the csc of genome g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig> first removes all genes from g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig> that are not δ-typical. then the synonymous codon frequencies of the remaining genes g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@typ are recomputed and the genes not δ-typical with respect to the new frequencies are removed from g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@typ. this is done as long as there are such genes in g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@typ. our experiments showed that this algorithm converged for all completely sequenced genomes to a csc g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@typ containing at least 75% of all genes. the atypical genes are those not contained in the csc g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@typ.

predicting genomic islands
using the viterbi algorithm , sigi-hmm computes at first the viterbi path . all genes labeled as atypical and all genes assigned to one of the states putalρ  are considered as belonging to gis. since it is reasonable to expect inside gis genes with a codon usage similar to native ones, gis separated by less than four native genes can optionally be merged. this merging distance can be set by the user.

selecting putative donors
for each genome g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig>  an individual set of putative donors g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig>  g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig>  ..., g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@r has to be selected. as these donors are reduced to their specific codon usage tables, we utilized the codon usage database    <cit> . those entries were extracted that consisted of more than  <dig>  codons. if a species was represented by more than one table, we took the entry sampling the largest number of codons. this pre-computing phase resulted in the selection of z =  <dig> codon usage tables. then, a z × z dissimilarity matrix d was set up. for each pair i, j of species, we calculated the value dij = 1/ <dig> - ηij. in order to compute the discriminative error ηij, we first considered the set of all "synthetic" genes each comprising  <dig> codons. each of the  <dig> codons was independently selected according to the codon frequencies qc
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgxbqcdaqhaawcbagaem4yamgabagaeiikagiaem4aasmaeiykakcaaaaa@32a4@. we then determined a probability distribution pk for each species k on this set. these distributions were utilized to determine ηij in analogy to equation  <dig> 

hierarchical divisive clustering  <cit>  was now applied to analyze the dissimilarity matrix d. as it was our aim to generate clusters representing taxonomically related species, we used the data basis of the taxonomy browser of the ncbi  <cit>  for the following procedure. first, we eliminated all entries, which could not be related to a taxonomical class. then, we generated for the initiation of the diversification process "class"-clusters consisting of species  belonging to the same taxonomical class. to test homogeneity of the clusters g, we computed for each entry i the average dissimilarity dissg
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgkbazcqqgpbqacqqgzbwccqqgzbwcdaqhaawcbagaem4raceabagaeiikagiaemyyaemaemodaynaeiykakcaaaaa@37e4@   according to

dissg:=1|g\{i}|∑j∈g\{i}dij.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgkbazcqqgpbqacqqgzbwccqqgzbwcdaqhaawcbagaem4raceabagaeiikagiaemyyaemaemodaynaeiykakcaaogaeiikagiaemyaakmaeiykakiaeiooaojaeyypa0zaasaaaeaacqaixaqmaeaacqgg8bafcqwghbwrcqggcbaxcqgg7bwecqwgpbqacqgg9bqfcqgg8bafaawaaabuaeaacqwgebardawgaawcbagaemyaakmaemoaaogabeaakiabc6cauawcbagaemoaaomaeyici4saem4rackaeiixawlaei4easnaemyaakmaeiyfa0habeqdcqghris5aaaa@5848@

in order to initiate the split of a cluster g, the element i ∈ g having the maximal dissg
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgkbazcqqgpbqacqqgzbwccqqgzbwcdaqhaawcbagaem4raceabagaeiikagiaemyyaemaemodaynaeiykakcaaaaa@37e4@  value was chosen. this i was the first element of a new cluster h. as long as the condition

max⁡k∈g−dissh)≥0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawfqaqaaigbc2gatjabcggahjabciha4bwcbagaem4aasmaeyici4saem4raceabeaakmaabmaabagaeeizaqmaeeyaakmaee4camnaee4cam3aa0baasqaaiabdeeahbqaaiabcicaoiabdggahjabdaha2jabcmcapaaakiabcicaoiabdugarjabcmcapiabgkhitiabbsgakjabbmgapjabbohazjabbohaznaadaaaleaacqwgibasaeaacqggoaakcqwghbqycqwg2bgdcqggpaqkaagccqggoaakcqwgrbwacqggpaqkaiaawicacaglpaaacqghljyscqaiwaamaaa@56e1@

was true, the element k generating the maximal dissg−dissh
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgkbazcqqgpbqacqqgzbwccqqgzbwcdaqhaawcbagaem4raceabagaeiikagiaemyyaemaemodaynaeiykakcaaogaeiikagiaem4aasmaeiykakiaeyoei0iaeeizaqmaeeyaakmaee4camnaee4cam3aa0baasqaaiabdieaibqaaiabcicaoiabdggahjabdaha2jabcmcapaaakiabcicaoiabdugarjabcmcapaaa@4a41@ value was transferred from g to h. starting with the initial set of class-clusters described above, the split procedure was applied to that cluster g having maximal diameter

diam g:=max⁡i,j∈gdij
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgkbazcqqgpbqacqqghbqycqqgtbqbcaamc8uaem4rackaeiooaojaeyypa0zaacbeaeaacyggtbqbcqgghbqycqgg4baeasqaaiabdmgapjabcycasiabdqgaqjabgigiolabdeeahbqabagccqwgebardawgaawcbagaemyaakmaemoaaogabeaaaaa@4533@

as long as that maximal diameter was greater than or equal to a threshold d <dig> .

the procedure resulted in r˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybgcgaacaaaa@2e28@ =  <dig> clusters. in order to select a typical example for each cluster, the frequency table having the lowest dissimilarity value to the barycenter of the cluster was chosen. the resulting r˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybgcgaacaaaa@2e28@ codon usage tables were regarded as representatives for putative sources of aliens genes.

to prevent false predictions, clusters with a composition too similar to the input genome g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig> have to be eliminated. therefore, the set of r˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybgcgaacaaaa@2e28@ codon usage tables was preprocessed during the initialization phase for g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig>  those elements were deleted, whose dissimilarity to the frequency table of g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@ <dig> was less than a threshold d <dig>  this procedure resulted in a g
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimaacqwfge=raaa@382d@0-specific set of r putative sources.

testing performance and analyzing genomes
to assess accuracy, sigi-hmm's predictions were compared with results published in  <cit> . in nearly all cases, the fraction of pa genes determined by sigi-hmm was lower; compare results listed in table  <dig>  this might be due to the focusing of sigi-hmm on the prediction of gis. however, for the genome of borrelia burgdorferi sigi-hmm predicts a significantly higher fraction of pa genes. the organization of this genome is unusual, it consists of  <dig> mainly linear replicons and is subject to frequent genomic rearrangements  <cit> . during these reorganization events integration of alien dna might take place making a larger fractions of pa genes for the b. burgdorferi genome plausible. in the following, we report in more detail findings deduced for genomic data sets of the following microbial genomes: vibrio cholerae, bacillus subtilis, escherichia coli k- <dig>  methanosarcina mazei, thermus thermophilus and propionibacterium acnes. the genome of v. cholerae consists of two chromosomes with a pronounced asymmetry in the distribution of coding elements with respect to the replicons  <cit> . most genes required for growth and virulence are located on chromosome i, whereas chromosome ii contains a larger fraction of hypothetical genes.

interestingly, sigi-hmm predicted  <dig> % pa genes for chromosome i and  <dig> % pa genes for chromosome ii. two predicted genomic islands on chromosome i comprise a gene cluster for a toxin-coregulated pilus  and fragments of a temperate filamentous phage . both clusters are closely associated with the pathogenicity of v. cholerae  <cit> . many of the hypothetical genes encoded on chromosome ii are located within a large integron island comprising gene products that might be involved in drug resistance, dna metabolism and virulence  <cit> . one of the predicted gis on chromosome ii, which consists of genes vca <dig> – vca <dig>  overlaps to a great extent the integron described above. sigi-hmm identified two additional gis comprising genes vca <dig> – vca <dig> and vca <dig> – vca <dig>  which contain homologs for putative transposases. as transposases are often encoded in genetically mobile is-elements, these genes are likely candidates for alien genes. for both chromosomes, sigi-hmm predicts similar distributions of putative donors. the largest fractions belong to the class of bacilli , whereas the taxonomical class of v. cholerae, the γ-proteobacteria, accounts for 34% or 37% of all pa genes.

for b. subtilis,  <dig> integrated prophages have been reported , whose identification is based either on experimental evidence or theoretical considerations. a profound analysis of chromosomal heterogeneities has been accomplished by nicolas et al.  <cit> , using a hmm on the nucleotide level. all genomic islands identified by nicolas et al. were largely confirmed by sigi-hmm. both approaches detected nine of the putative prophages and several other islands assigned to functions in cell wall biosynthesis, competence and resistance. in contrast to nicolas et al., sigi-hmm identified pa genes, which belong to the experimentally reported integrated prophage pbsx  <cit> . in summary, sigi-hmm predicted for b. subtilis  <dig> % of the genes as being pa, most of them originating from the class of bacilli .

based on a combination of parameters measuring computational complexity, lawrence and ochman  <cit>  had estimated that about 18% of the e. coli k- <dig> genome have been imported via lateral gene transfer. in contrast, sigi-hmm predicted  <dig>  pa genes which were mostly organized in small clusters of less than ten genes.  <dig> pa genes  seem to originate from γ-proteobacteria, the taxonomical class e. coli belongs to. the largest gis included the cryptic prophages cp4- <dig> , dlp <dig> , e <dig> , rac , qin , cp4- <dig> , cps- <dig> , eut , cp4- <dig> , and the phage-like element kple <dig>  .  <dig> is-elements have been annotated within the genome of e. coli k- <dig>  sigi-hmm predicted  <dig> of them correctly.

t. thermophilus is an extreme thermophilic bacterium living as a halotolerant in an extreme ecological niche. two t. thermophilus strains, namely hb <dig>  <cit>  and hb <dig>  <cit> , have been sequenced so far. sigi-hmm predicted for both strains a small fraction of pa genes . the largest pa cluster consists of  <dig> genes in case of hb <dig>  and of  <dig> genes in case of hb <dig> . the gis share no sequence similarity and contain genes that are associated with functions in cell wall biosynthesis. most pa genes seem to originate from the class of the δ-proteobacteria . in both genomes no donor was predicted for  <dig> pa genes, respectively.

it has been suggested that hgt plays an important role in the evolution of the mesophilic archaeon m. mazei  <cit> . the analysis of protein sequences via blast showed that 31% of the archeal sequences were more similar to bacterial than to archeal ones. sigi-hmm predicted for m. mazei only  <dig> % pa genes. please note that the two analyses used different approaches for pa prediction and that sigi-hmm focuses on the analysis of gis only. these systematic differences may explain the findings. interestingly and in agreement with the above analysis, only 21% of the pa genes seem to originate from the archeal domain. 27% of the pa genes were predicted to originate from the class of shingobacteria, 23% from chlamydia and 11% from clostridia. this finding is also in agreement with the postulated gene flux from mesophilic bacteria to mesophilic archaea  <cit> .

p. acnes is a major inhabitant of the adult human skin, living in sebaceous follicles  <cit> . usually the bacterium is harmless; however it is involved in acne vulgaris formation. the genome harbors genes whose products are involved in degrading host molecules and pore-forming factors. it also contains surface-associated and other immunogenic factors, which might be responsible for acne inanimation and other p. acnes-associated diseases. sigi-hmm predicted  <dig> % pa genes clustered in five larger gis and several smaller islands of less than five genes. 47%  of them are predicted to originate from the α-proteobacteria, but only 13%  from the taxonomic class of p. acnes, the actinobacteria. interestingly, four of the larger gis and two of the smaller islands are flanked by trna-genes in direct or close vicinity. trnas are considered to be hot spots for recombination events that can result in horizontal gene transfer. sigi-hmm found these anomalies although it does not interpret sequences besides protein coding genes. of the larger gis, the first  contains genes without functional assignment, the second  harbors genes for several transport systems among others for irondicitrate  and the third  for an abc-type transport system , putative conjugal transfer proteins  and two putative transposases . the forth gi  contains a gene cluster for a putative non-ribosomal peptide synthetase  . nrpss are involved in the biosynthesis of complex secondary metabolites. as many of the genes clustered in the fifth gi  are annotated as phage-associated proteins , the gi may be attributed to an integrated prophage.

for visualization of the hmm-based predictions we use scatter plot repesentations providing an overview of codon usage similarities between all genes of a genome. by means of a newly developed kernel for measuring similarity of codon usage tables  <cit> , we perform a kernel principal component analysis  to compute the resulting 2d coordinates of all genes. in that representation, nearby points indicate a similar codon usage of the corresponding genes. it is important to note that the kernel-based approach does not use any information about the location of genes on the genome. instead, codon usage correlations between different amino acids are used to derive the two-dimensional representation. this approach is different from the concept of sigi-hmm. therefore, a clustering of sigi-hmm predicted pa genes which becomes visible in the scatter plots  confirms the corresponding predictions.

t. thermophilus is one of the genomes with lowest pa content. the plot depicted in figure  <dig> represents the genome of t. thermophilus and has a quite specific shape. this finding indicates that the overall shape of the plot is massively modulated by the fraction of genes acquired via hgt. the pa genes as predicted by sigi-hmm are mainly located in a long tail with low point density on the right hand side of the plot.

as already mentioned, the genome of v. cholerae consists of two chromosomes. most essential genes are located on chromosome i and codon usage of genes on chromosome ii is rather inhomogeneous. again, the overall shape of the plot, which represents chromosome ii, reflects this situation  and shows a well-clustering fraction of pa genes located in the lower left corner of the plot. please note that the positioning of pa genes predicted by sigi-hmm only and those pa genes supported by additional evidence from the literature corresponds to a great extent in all plots.

assessing the patchiness of gis
genomic islands are thought to be the result of constant genetic rearrangement events, which account for their observed mosaic structure. as these rearrangements could also take place at hot spots for the integration of alien dna in the host genome, patches of genes having a codon usage similar to the host have to be expected inside gis. this fact makes it difficult to determine the number of false negatives, even in annotated gis. the number of false positives is difficult to deduce too, as it is hard to proof that a stretch of pa genes has not been acquired via hgt. in order to illustrate the problem and the patchiness of gis, we compare in more detail some predictions with published findings.

chromosome ii of v. cholerae contains an integron island of size  <dig>  kbp, which includes genes vca <dig> to vca <dig>  <cit> . of these  <dig> genes, sigi-hmm labels  <dig> as pa ,  <dig> as at  and  <dig> as pn . sigi-hmm did subdivide the integron island into the following patches: vca <dig> – vca <dig> pn, vca <dig> – vca <dig> pa, vca <dig> – vca <dig> pn, vca <dig> – vca <dig> pa, vca <dig> – vca <dig> pn, vca <dig> – vca <dig> pa, vca <dig> – vca <dig> pn, vca <dig> – vca <dig> pa. from the remaining  <dig> genes on the chromosome,  <dig> were predicted as pa.

the chromosome of mesorhizobium loti consists of  <dig>  protein coding genes. it contains a  <dig> kbp dna segment which is, as the authors put it, "a highly probable candidate of a symbiotic island"  <cit> . sigi-hmm predicted  <dig>  genes as pn,  <dig>   as pa and  <dig> as at. of the symbiotic island,  <dig> genes were pn,  <dig> pa  and  <dig> at. the pa genes were clustered in  <dig> gis ranging in size from  <dig> to  <dig> genes.

as already mentioned, ten integrated prophages or prophage-like elements were reported for the genome of b. subtilis  <cit> . five of these elements are flanked by sequence repeats which we considered as the original integrations sites indicating the actual borders of the gis. table  <dig> summarizes composition and location of related gis predicted by sigi-hmm. skin prophage and p <dig> have a mosaic structure and harbour ≈ 50% pn genes. in four of the five cases, the borders of the predicted gis are in good agreement with the location of the repeats.

discussion
analysis of codon usage reliably allows to identify most hgt events
we have to stress that our approach entirely relies on the analysis of codon usage. sigi-hmm does not interpret additional signals like direct repeats or disrupted trna sequences frequently flanking gis. therefore, the outcome of the hmm analysis are dna regions showing atypical codon usage. this fact has two consequences: 1) sigi-hmm is unable to identify gis having an unsuspicious codon usage and 2) the rationale of naming these stretches gis merely depends on the correlation with biological findings.

however, we have shown that dna regions identified by sigi-hmm as suspicious correspond to known cases of horizontally transferred elements like phages. our approach of focusing on the analysis of codon usage is not a completely new one. there exist several methods to identify horizontally transferred genes. these approaches rely on the analysis of codon or amino acid sequences or the construction of phylogenetic trees. for a comparison see e.g.  <cit> . each approach has individual drawbacks and it might be that each method identifies a specific class of genes acquired in a different time of genome evolution  <cit> . it was argued that codon usage is no reliable indicator for the study of hgt  <cit> . however, it was shown that related methods identify pa genes to a great extent  <cit> . the assumption that methods analyzing codon usage might overlook horizontally acquired genes could be valid for more ancient events. for these genes, the effect of amelioration  <cit>  might have rendered codon usage unsuspicious. lawrence and ochman estimated the age of imported genes  <cit> . their conclusion was that most were relatively recent, i.e. acquired within the last few million years; see also  <cit> . this suggests that older imports have been purged presumably because the acquired genes did not improve fitness. if this argument is true, there is no need to search for larger amounts of ancient pa genes. therefore, methods based on the analysis of codon usage should have the potential of identifying a great fraction of horizontally transferred genes. low values of pa content can frequently be explained with biological findings. it was argued that species populating extreme ecological niches tend to have relative small genomes  <cit> . the size of the sequenced t. thermophilus genomes support this notion. if selective pressure minimizes genome size, it will also effect acquisition and conservation of foreign dna. the low fraction of pa genes determined for both strains is in agreement with the above hypothesis.

the methods will fail at alien genes having a codon usage undistinguishable from the host's preferences. among them might be ancient pa genes. because of the amelioration process, ancient pa genes are harder to detect. these pa genes, surviving the selection process may actually constitute important and useful genes. in order to complete the set of identified hgt events and to reduce the number of false negatives, it will be necessary to use a completely different approach like the construction of phylogenetic trees.

if not processed correctly, highly expressed genes could be a source for false positive predictions. it is known that these genes show a distinct codon usage by preferring a species-specific set of major codons. in order to reduce the rate of false positive predictions, we use a filter which is based on a method  <cit>  shown to be effective in predicting gene expressivity  <cit> . we have adjusted the parameters  in such a way that the errors of the first and second kind are equally likely. highly expressed genes belong to the core of a genome and it is unlikely that these genes are subject to hgt. nevertheless, the user may disable this filter in order to study its influence on gi prediction.

focusing on the prediction of gis is biologically reasonable and reduces the risk of false predictions
intrinsically, increasing the sensitivity of a test also increases the risk of predicting false positives. for the prediction of pa genes, the risk can however be minimized, if an algorithm focuses on the prediction of genomic islands as sigi-hmm does. the pieces of dna acquired via hgt typically have a considerable length. examples are the symbiotic island of size  <dig> kbp described for the genome of m. loti or the integron island of size  <dig> kbp found on chromosome ii of v. cholerae . genes responsible for pathogenicity are also agglomerated in islands; see  <cit>  and references therein. therefore, a focusing on predicting gis rather than all pa genes is an appropriate strategy to avoid false positives without missing relevant hgt events. consequently, this argument was considered for the design of recently introduced algorithms  <cit> . however, the rate of false positive predictions will increase, if codon usage of a genome is inhomogeneous. to avoid this situation, it is important, to determine the csc of a genome.

codon usage is a reliable indicator to predict the origin of pa genes
for each completely sequenced genome, we have computed a variant of the csc defined above; see  <cit> . it consisted of those genes having a homogeneous codon usage. the results obtained with the classification of genes from cscs show that codon usage hints at the origin of genes. first tests indicate that prediction quality is high, as long as the csc contains at least 70% of the genes. in addition, the results of performance tests  carried out to demonstrate sigi's ability of predicting the putative donor are also valid for sigi-hmm.

omelchenko et al.  <cit>  used blast on the protein level to determine hgt events in the genome of t. thermophilus hb <dig>  the protein sequences of many genes were similar to those of hyperthermophilic archaea. taxonomical classification of donors for genes constituting gis predicted by sigi-hmm was rather inhomogeneous. the putative donors belonged to bacteria, archaea and eukaryota. it will be necessary to evaluate methods for pa prediction with a standardized test bed. artificial genomes as introduced recently  <cit>  may constitute the basis for such a validation, which may lead to a contest of methods for pa prediction.

CONCLUSIONS
an inhomogeneous hmm on gene level allows to identify gis in microbial genomes and to predict the putative donor of horizontally transferred genes. the predictions are consistent with known findings and do not depend on the optimization of many parameters. our implementation as a freely available tool written in java allows an independent inspection of genomes in great detail. the genome-specific predictions can be used for further analysis or the comparison of several methods.

authors' contributions
sw and rm specified the problem and the solution strategy. sw developed the hmm together with ok and ks and provided resources. ok and tb implemented the hmm. the donor selection was conceptualized by sw, ra and cd, and implemented by ra. wff analyzed the genomes. pm decisively contributed to the methods measuring similarity of codon usage tables. rm conducted the performance tests and contributed substantially to the manuscript which was prepared together with sw and ks. all authors read and approved the final manuscript.

