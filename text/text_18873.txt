BACKGROUND
a nearly complete collection of gene-deletion mutants  of the yeast saccharromyces cerevisiae has been systematically constructed  <cit> . each deletion is marked with two unique oligonucleotide tags, making it possible to use microarrays and the tag arrays  <cit>  to measure the relative abundance of each mutant strain in a mixture. the relative fitness of every individual gene deletion mutant can be compared across multiple intercellular environments. a general question of interest is which gene-deletion and environment interaction is most lethal or most viable.

every mutant is barcoded with two tags, namely the uptag and the downtag. the two tags are deletion-specific. they are synthesized into the genome of the deletion strain at the location of the deleted gene. for affymetrix tag arrays, four probes on the microarray are designed to hybridize to the sense and antisense strands of each tag. these probe sets are indicated by perfect match , mis-match , complementary perfect match , and complementary mis-match . in summary, every mutant strain is represented by eight probe readouts: uptag-pm, uptag-cpm, uptag-mm, uptag-cmm, downtag-pm, downtag-cpm, downtag-mm, downtag-cmm . please refer to  <cit>  for details of agilent tag arrays.

a general experiment design is a two-environment, multiple-time-point design  <cit> . two mixtures of gene-deletion mutants are grown under two different environmental conditions: a drug-treated condition and a control condition. mutant samples are collected from both collections at a series of time points, e.g.,  <dig>   <dig>  and  <dig> cell generations. dna of these samples are retrieved, amplified, and hybridized to tag arrays. we summarize the experimental designs and analytical procedures in published literature at below and in table  <dig> 

a few analytical procedures have been proposed to analyze tag microarray data.  most of these procedures were designed to handle a specific dataset generated by a specific experiment, and therefore are not applicable to analyzing other data generated from a different experimental design, with exceptions to the procedure described by giaever et al.  <cit>  and the procedure we recently proposed  <cit> . the latter procedure is more general than the giaever procedure because it can handle treatment with multiple dosages. the tagsmart software implements the latter procedure . when there is a complex experimental design , tagsmart will take the most advantage of the comprehensive data available. when data is generated from a simple experimental design, the tagsmart procedure will automatically degenerate into a simpler procedure.

 <dig>  implementation
 <dig>  tagsmart software
tagsmart  <cit>  is a web application that can be operated by web browsers, such as mozilla firefox, safari, and internet explorer. tagsmart also has a downloadable version for execution on pcs running on windows. tagsmart has three modules: data preprocessing, computation, and visualization.

data preprocessing module
the data preprocessing module integrates data files and annotation files into one easily interpretable data file. the following files are required as input files to the preprocessing module: 1) a series of tag array data files, in either cel or txt format; 2) a chip description file ; 3) an array description file; 4) a tag mask file; and 5) a user-supplied experiment description file. except that the tag array data files and experiment description file should be provided by the user, all the other files can be downloaded from the tagsmart website. the cel format data files are direct outputs of an affymetrix scanner. if users have applied affymetrix software such as gcos  <cit>  to process the data, they may have data files in txt format. tagsmart allows users to supply data files in either cel or txt format. the cdf file records the coordinates of each tag on the tag microarray. the array description file links each tag to its corresponding open reading frame and gene name. because the same tag was used to make both the homozygous deletion mutant  <cit>  and the heterozygous deletion mutant  <cit> , the analysis of heterozygous and homozygous mutants share the same array description file . the tag mask file records a list of tags that do not show "responsiveness" to the concentration change of their corresponding mutants. these tags are considered to be bad . the user can choose to mask out the "bad" tags in the subsequent analysis by clicking on the "bad tag filtering" checkbox . finally, the experiment description file is a user-supplied file, recording the experimental condition  for each array data file. users should follow the instruction on the tagsmart help-page to construct this file. the output of the preprocessing module is an easily interpretable data file in tabular format. instead of averaging the multiple signals of a mutant , the preprocessing module retains them individually in the output.

computation module
by choosing the radio button of "analyze a preprocessed data file" in the main page, users activate the computation module. users should specify desired criteria for selecting mutants in the subsequent webpage . fold change  and q-value  are allowed. if the user has array data for a common pool of mutant mixture, such as a time  <dig> sample before the separation of mutant growth in treatment and control, she/he can choose to use such data to get more precise estimate of mutant growth rates. this is achieved by checking the "generation- <dig> correction" check box . advanced users are also allowed to tune a parameter called the number of permutations. as in the statistical procedure section described below, tagsmart employs a matched permutation method to obtain background distribution. the number of permutation is positively correlated with the accuracy of computation but also computation time. we suggest a default number of  <dig> permutations, which is a balance between accuracy and time. additional file  <dig> gives an example text output of a computation. mutants that satisfied the user-defined thresholds are listed. their related information, including open reading frame's name , gene name, the two associated tags, p-value, q-value, and fold change are provided. users can sort the output by any information with a click on the corresponding column name. a more comprehensive report, including the actual data and experimental conditions, can be saved as a text file by clicking the disk icon on the output webpage.

visualization module
an interactive graphical display of the computation result is accessible by clicking the "heatmap" icon after the computation . alternatively, the saved report file on a user's local computer can be uploaded onto the server and visualized using the visualization module. tagsmart adopts heatmap as the way to present mutant's relative concentration. the first two rows in the heatmap use a novel color scheme to represent experimental design information. the first row represents the treatment factor . the second row represents the time factor . from the third row on, a traditional heatmap is applied to show the relative concentration of each mutant. red represents higher concentration and green represents lower concentration. detailed information on treatment, time, and array signal can be monitored by moving mouse cursor over the corresponding color-coded region .

we tested tagsmart with multiple web browsers under linux, macos, and windows operation systems. tagsmart is implemented with c# programming language and asp.net technology. tagsmart is currently hosted on a dell rack server with dual  <dig> ghz intel xeon dual-core processors and 6gb ram. a standalone executable for windows is also downloadable from the tagsmart website.

 <dig> . statistical procedure
we describe tagsmart's statistical procedure assuming data comes from the most complicated setting . this procedure automatically degenerates into a simpler procedure when data comes from a simpler experimental design.

array signals are first normalized to make 1% trimmed mean the same across all arrays  <cit> . let yiαβγδτ be the normalized signal for mutant i, in environmental condition α, at time point β, measured by tag γ  and probe δ , on the replicate array τ. for notational simplicity, we will suppress the mutant indicator i hereafter. when time- <dig> data is available, users can use the following metric to represent the growth rate measured by a probe at time β: xαβγδτ=yαβγδτ−yβ= <dig> γδ¯yβ= <dig> γδ¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwg4baedawgaawcbaaccigae8xsdemae8nsdimae83sdcmae8htdqmae8hxdqhabeaakiabg2da9maalaaabagaemyeak3aasbaasqaaiab=f7ahjab=j7aijab=n7anjab=r7akjab=r8a0bqabagccqghsisldaqdaaqaaiabdmha5naabaaaleaacqwfyogycqgh9aqpcqaiwaamcqggsaalcqwfzowzcqwf0oazaeqaaaaaaoqaamaanaaabagaemyeak3aasbaasqaaiab=j7aijabg2da9iabicdawiabcycasiab=n7anjab=r7akbqabaaaaaaaaaa@5569@, where yβ= <dig> γδ¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdmha5naabaaaleaaiigacqwfyogycqgh9aqpcqaiwaamcqggsaalcqwfzowzcqwf0oazaeqaaaaaaaa@3622@ is the average across all array replicates at time- <dig>  the growth rate measurement xαβγδτ was inspired by the coefficient of variation  statistic. with the observation that signals with larger magnitude usually have larger variability, xαβγδτ can be regarded as a signal for concentration change, with the raw signal intensity penalized. when time- <dig> data is not available, the normalized signal is directly passed onto the next step: xαβγδτ = yαβγδτ.

to compare the difference of concentration changes between different experimental conditions, we first compute a modified t statistic:

 t=xα=trt¯−xα=contr¯s+s0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubavcqgh9aqpdawcaaqaamaanaaabagaemieag3aasbaasqaaggaciab=f7ahjabg2da9iabdsha0jabdkhayjabdsha0bqabaaaaogaeyoei0yaa0aaaeaacqwg4baedawgaawcbagae8xsdemaeyypa0jaem4yammaem4ba8maemoba4maemidaqnaemocaihabeaaaaaakeaacqwgzbwccqghrawkcqwgzbwcdawgaawcbagaegimaadabeaaaaaaaa@48ce@ 

where xα=trt¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdiha4naabaaaleaaiigacqwfxoqycqgh9aqpcqwg0badcqwgybgccqwg0badaeqaaaaaaaa@355d@ and xα=contr¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdiha4naabaaaleaaiigacqwfxoqycqgh9aqpcqwgjbwycqwgvbwbcqwgubgbcqwg0badcqwgybgcaeqaaaaaaaa@3807@ are average concentration changes under treated and untreated conditions, respectively. if the treatment was conducted with multiple dosages, xα=trt¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdiha4naabaaaleaaiigacqwfxoqycqgh9aqpcqwg0badcqwgybgccqwg0badaeqaaaaaaaa@355d@ is computed with all the data from all dosages. s is the pooled standard deviation of all data. it is computed by:

 s=×{∑α=trt,β,γδτ2+∑α=contr,β,γδτ2}n1+n2−2)12
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgzbwccqgh9aqpdaqadaqaamaalaaabawaaewaaeaadawcaaqaaiabigdaxaqaaiabd6gaunaabaaaleaacqaixaqmaeqaaaaakiabgucarmaalaaabagaegymaedabagaemoba42aasbaasqaaiabikdayaqabaaaaagccagloagaayzkaagaey41aqraei4eas3aaabuaeaacqggbbwwcqwg4baedawgaawcbaaccigae8xsdemaeyypa0jaemidaqnaemocainaemidaqnaeiilawiae8nsdimaeiilawiae83sdcmae8htdqmae8hxdqhabeaakiabgkhitmaanaaabagaemieag3aasbaasqaaiab=f7ahjabg2da9iabdsha0jabdkhayjabdsha0bqabaaaaogaeiyxa01aawbaasqabeaacqaiyagmaaaabagae8xsdemaeyypa0jaemidaqnaemocainaemidaqnaeiilawiae8nsdimaeiilawiae83sdcmae8htdqmae8hxdqhabeqdcqghris5aogaey4kasyaaabuaeaacqggbbwwcqwg4baedawgaawcbagae8xsdemaeyypa0jaem4yammaem4ba8maemoba4maemidaqnaemocainaeiilawiae8nsdimaeiilawiae83sdcmae8htdqmae8hxdqhabeaakiabgkhitmaanaaabagaemieag3aasbaasqaaiab=f7ahjabg2da9iabdogajjabd+gavjabd6gaujabdsha0jabdkhaybqabaaaaogaeiyxa01aawbaasqabeaacqaiyagmaaaabagae8xsdemaeyypa0jaem4yammaem4ba8maemoba4maemidaqnaemocainaeiilawiae8nsdimaeiilawiae83sdcmae8htdqmae8hxdqhabeqdcqghris5aogaeiyfa0habagaemoba42aasbaasqaaiabigdaxaqabagccqghrawkcqwgubgbdawgaawcbagaegomaidabeaakiabgkhitiabikdayaaaaiaawicacaglpaaadaahaawcbeqaamaalaaabagaegymaedabagaegomaidaaaaaaaa@b184@ 

where ∑α=trt
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaeqbqaaawcbaaccigae8xsdemaeyypa0jaemidaqnaemocainaemidaqhabeqdcqghris5aaaa@35ca@ denotes sum over all treated signals. if there are multiple dosages, all these dosages should be summed. n <dig> and n <dig> are the numbers of x s under treated and untreated conditions, respectively. s <dig> is a small positive constant  that ensures t not outrageously large.

we use a matched permutation strategy to generate background distribution for the t statistic. to illustrate the matched permutation procedure, we assume that data comes from the following hypothetical experiment. let a and b denote two mutant mixtures treated with high and low dosages of a drug, respectively. mutant mixtures c and d are replicates grown under control condition. mutant samples are collected at  <dig> and  <dig> cell generations. in this hypothetical experiment,  <dig> tag arrays are used to gather data. we permute xαβγδτ with the same time , tag , and probe . to see this permutation procedure graphically, signals are arranged in figure  <dig> and color coded. the signals are permutated under the constraint that a signal can only be switched to a box with the same color as its original one.

with k permutations, we obtain k new statistics tk, k =  <dig>   <dig>  ..., k. we compute a q-value  for every mutant. the statistical interpretation for a mutant's q-value is: if the threshold is set so that this mutant is the last mutant to be called significant, the q-value is the estimated percentage of false positives among all the mutants being called significant. we compute the q-value for a mutant by  <cit> :

q^=1k∑k=1k∑j=1ni{|tjk| ≥ |t|}max⁡{ <dig> ∑j=1ni{|tj| ≥ |t|}π^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgxbqcgaqcaiabg2da9maalaaabawaasaaaeaacqaixaqmaeaacqwglbwsaawaaabcaeaadaaewbqaaiabdmeajjabcuha7jabcyha8jabdsfaunaadaaaleaacqwgqbgaaeaacqwgrbwaaagccqgg8bafcqqggaaicqghljyscqqggaaicqgg8bafcqwgubavcqgg8bafasqaaiabdqgaqjabg2da9iabigdaxaqaaiabd6eaobqdcqghris5aogaeiyfa0haleaacqwgrbwacqgh9aqpcqaixaqmaeaacqwglbwsa0gaeyyeiuoaaoqaaigbc2gatjabcggahjabciha4jabcuha7jabigdaxiabcycasmaaqahabagaemysakkaei4easnaeiifawnaemivaq1aasbaasqaaiabdqgaqbqabagccqgg8bafcqqggaaicqghljyscqqggaaicqgg8bafcqwgubavcqgg8bafasqaaiabdqgaqjabg2da9iabigdaxaqaaiabd6eaobqdcqghris5aogaeiyfa0haaggaciqb=b8awzaajawaasbaasqaaiabicdawaqabagccqggoaakcqwgjbwydawgaawcbagaegimaadabeaakiabcmcapaaa@785d@, where j =  <dig>   <dig>  ..., n is the index for mutants. t is the t-statistic computed from un-permuted data. π^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfapacgaqcamaabaaaleaacqaiwaamaeqaaogaeiikagiaem4yam2aasbaasqaaiabicdawaqabagccqggpaqkaaa@33c9@ is the estimated proportion of mutants with no fitness difference between experimental conditions. π^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfapacgaqcamaabaaaleaacqaiwaamaeqaaogaeiikagiaem4yam2aasbaasqaaiabicdawaqabagccqggpaqkaaa@33c9@ is estimated by  <cit> :

π^0=1n∑j=1ni{|tj|<c0}1nk∑k=1k∑j=1ni{|tjk|<c0}, and c <dig> is a pre-defined constant . the choice of c <dig> does not affect the estimate of π^0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfapacgaqcamaabaaaleaacqaiwaamaeqaaogaeiikagiaem4yam2aasbaasqaaiabicdawaqabagccqggpaqkaaa@33c9@ as long as c <dig> is reasonably small  <cit> .

finally, the fold change  between treatment and control is computed by:

fc=∑βaβ×fcβ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwggbgrcqwgdbwqcqgh9aqpdaaeqbqaaiabdggahnaabaaaleaaiigacqwfyogyaeqaaaqaaiab=j7aibqab0gaeyyeiuoakiabgena0kabdaeagjabdoeadnaabaaaleaacqwfyogyaeqaaaaa@3cb6@. it is a weighted sum of each time point fold change. we require ∑βaβ=1
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaeqbqaaiabdggahnaabaaaleaaiigacqwfyogyaeqaaogaeyypa0jaegymaedaleaacqwfyogyaeqaniabgghildaaaa@358a@. larger aβ will stress the importance of that β time point. fcβ is the fold change at time β. it is defined as:

 fcβ=1#∑γ∑δ∑α=trt∑τxαβγδτ∑α=contr∑τxαβγδτ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwggbgrcqwgdbwqdawgaawcbaaccigae8nsdigabeaakiabg2da9maalaaabagaegymaedabagaei4iamiaeiikagiae83sdcmaeiilawiae8htdqmaeiykakcaamaaqafabawaaabuaeaadawcaaqaamaaqafabawaaabuaeaacqwg4baedawgaawcbagae8xsdemae8nsdimae83sdcmae8htdqmae8hxdqhabeaaaeaacqwfepadaeqaniabgghildaaleaacqwfxoqycqgh9aqpcqwg0badcqwgybgccqwg0badaeqaniabgghildaakeaadaaeqbqaamaaqafabagaemieag3aasbaasqaaiab=f7ahjab=j7aijab=n7anjab=r7akjab=r8a0bqabaaabagae8hxdqhabeqdcqghris5aawcbagae8xsdemaeyypa0jaem4yammaem4ba8maemoba4maemidaqnaemocaihabeqdcqghris5aaaaasqaaiab=r7akbqab0gaeyyeiuoaasqaaiab=n7anbqab0gaeyyeiuoaaaa@7130@ 

where α, β, γ, δ, and τ are defined the same as above. it is worth noticing that tagsmart does not first average all probe signals and then take the ratio, but rather it first takes ratio on the same probe and then averages over all tags and probes. tagsmart jointly uses q-value and fc to call significant mutants.

 <dig>  
RESULTS
titration experiment
to illustrate tagsmart's performance, we did a titration experiment using homozygous deletion mutants. eight mutant mixture pools were made, which were denoted as pools a, b, c, d, e, f and g, respectively. the mutants had roughly equal concentrations in mixture pools a and g. one sixth of the mutants were diluted into 1/ <dig> concentration whereas the concentration of the rest mutants were untouched in pool b. another one sixth, not overlapping with the first one sixth, were diluted to 1/ <dig> concentration in pool c, so did pools d, e, and f. in the end pools b to f each had one sixth of the mutants diluted. dna from each mutant pool was hybridized to a tag microarray. tagsmart procedure was applied to identify the mutants with lower concentration in pools c to g. a wide range of thresholds for determining the mutants with lower concentration were applied, and for each threshold the computationally identified mutants were compared to the real diluted mutants. we computed the precision and the recall of tagsmart procedure . precision and recall are defined as follows.

 precision ={true positive} ∩ { predicted positive }{ predicted positive }
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgqbaucqqgybgccqqglbqzcqqgjbwycqqgpbqacqqgzbwccqqgpbqacqqgvbwbcqqgubgbcqqggaaicqgh9aqpdawcaaqaaiabbuha7jabbsfaujabbkhayjabbwha1jabbwgaljabbccagiabbchawjabb+gavjabbohazjabbmgapjabbsha0jabbmgapjabbaha2jabbwgaljabb2ha9jabbccagiablmiijjabbccagiabbuha7jabbccagiabbcfaqjabbkhayjabbwgaljabbsgakjabbmgapjabbogajjabbsha0jabbwgaljabbsgakjabbccagiabbchawjabb+gavjabbohazjabbmgapjabbsha0jabbmgapjabbaha2jabbwgaljabbccagiabb2ha9bqaaiabbuha7jabbccagiabbcfaqjabbkhayjabbwgaljabbsgakjabbmgapjabbogajjabbsha0jabbwgaljabbsgakjabbccagiabbchawjabb+gavjabbohazjabbmgapjabbsha0jabbmgapjabbaha2jabbwgaljabbccagiabb2ha9baaaaa@8a42@ 

 recall ={true positive} ∩ { predicted positive }{ true positive }
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgsbgucqqglbqzcqqgjbwycqqghbqycqqgsbabcqqgsbabcqqggaaicqgh9aqpdawcaaqaaiabbuha7jabbsfaujabbkhayjabbwha1jabbwgaljabbccagiabbchawjabb+gavjabbohazjabbmgapjabbsha0jabbmgapjabbaha2jabbwgaljabb2ha9jabbccagiablmiijjabbccagiabbuha7jabbccagiabbcfaqjabbkhayjabbwgaljabbsgakjabbmgapjabbogajjabbsha0jabbwgaljabbsgakjabbccagiabbchawjabb+gavjabbohazjabbmgapjabbsha0jabbmgapjabbaha2jabbwgaljabbccagiabb2ha9bqaaiabbuha7jabbccagiabbsfaujabbkhayjabbwha1jabbwgaljabbccagiabbchawjabb+gavjabbohazjabbmgapjabbsha0jabbmgapjabbaha2jabbwgaljabbccagiabb2ha9baaaaa@7f70@ 

the titration experiment allows us to detect the "bad" tags that do not show consistent signal change for the diluted mutants. each mutant is diluted in one of the eight mixture pools. the diluted concentration is 1/ <dig> of the concentration of the undiluted concentration. we employed the following procedure to detect "bad" tags. for each tag, its signal from the diluted pool is compared to the average signal of this tag from the other seven undiluted pool . a tag is regarded as "bad" if its signal from the diluted pool is not smaller than its average signal from the undiluted pools. the "bad" tags are recorded into the tag mask file, which, by user's discretion, can be used to eliminate the bad tags from the subsequent analysis . one reason for a tag being "bad" can attribute to the mutations of the synthetic dna tags introduced during the construction of the deletion strains  <cit> . we note that a "bad" tag should not be taken literally, because there are many reasons that can contribute to inconsistency between the signal of a tag and the concentration change. for example, cross-hybridization to the probe on the array may contribute to the inconsistency.

cincreasin experiment
to illustrate the power of tagsmart in a real biological investigation, we applied tagsmart on a tag array dataset  <cit> . this dataset records the tag array measurements of heterozygous deletion mutants under four experimental conditions, including rich medium ,  <dig>   <dig>  and  <dig> um treatment of a chemical called cincreasin. cincreasin is a newly synthesized molecule that inhibits the spindle checkpoint process by targeting mps <dig> protein  <cit> . additional file  <dig> summarizes this dataset. we restricted our analysis on  <dig> um treatment data only.

tagsmart identified  <dig> mutants as sensitive to cincreasin treatment . additional file  <dig> shows the fold changes of top  <dig> most sensitive mutants. among theses mutants, mps <dig> was shown to be the direct target of cincreasin  <cit> . mps <dig> is a dual-specificity kinase required for spindle pole body duplication and spindle checkpoint function  <cit> . cincreasin blocks the spindle checkpoint response to a lack of tension on mitotic chromosome by inhibiting mps <dig>  however, the other mutants besides mps <dig> being sensitive to cincreasin might indicate that there is an aftermath of chained molecular responses to the inhibition of mps <dig> 

to validate these findings, we re-tested all the  <dig> heterozygous mutants individually with cincreasin treatment in colonial growth assay . mutant strains were grown in colonies in the same control environment as described in  <cit>  and in  <dig> um and  <dig> um cincreasin treated environments. three wild type colonies were grown under each environment as negative controls. cin <dig> homozygous deletion strain was used as positive control , because cincreasin has been previously shown to cause mis-segregation of chromosomes in cin <dig> null cells . in this test,  <dig> out of the  <dig> predicted mutants showed significant sensitivity to cincreasin in this test, comparing to three wild type colonies . this high validation rate demonstrates tagsmart is very resistant to false positive reports. we recognize that due to the limited amount of mutant colonies we could test, it is infeasible for this test to address the amount of false negative reports. the titration experiment described previously in this paper did address both false positive and false negative reports.

the validated mutants fell into three classes: i) mutants with lesions in known components of the spindle, ii) mutants in genes of known function which lack any described role in chromosome segregation, and iii) mutants in genes of unknown function. the first functional category is highly relevant to the function of cincreasin, an inhibitor of buddy yeast spindle checkout. it is worth further investigation whether the second class reflects additional molecular targets of cincreasin that lie outside the spindle checkpoint, or previously undiscovered roles in spindle function for this class of genes.

 <dig>  
CONCLUSIONS
tag microarray data has inspired various research, including identification of gene function  <cit> , identification of drug targets  <cit> , and evolution and genetic robustness  <cit> . tagsmart is an interactive online software tool for the analysis of tag microarray data. it is freely available for non-commercial use at  <cit> . our future work is to expand tagsmart for integrated analysis with other genomics data, such as expression data and double deletion mutant data.

availability and requirements
project name: tagsmart

project home page: 

operating systems: platform independent

programming language: c#, asp.net

other requirements: none

license: none

restrictions to use by non-academics: licence needed

authors' contributions
sz conceived the study, designed the analytical procedure, the software and the biological experiments. ck, sk and jh implemented the software. sz, ck, sk and dx analyzed the data. rd performed the biological experiments. sz coordinated the study and wrote the paper. all authors read and approved the final manuscript.

supplementary material
additional file 1
a generic gene-deletion cassette module. supplementary figure 1

click here for file

 additional file 2
summary of previous methods. supplementary document

click here for file

 additional file 3
screenshot of the preprocessor module. supplementary figure 2

click here for file

 additional file 4
screenshot of the computation module. supplementary figure 3

click here for file

 additional file 5
an example text output from tagsmart server. supplementary figure 4

click here for file

 additional file 6
summary of the cincreasin dataset. supplementary table 1

click here for file

 additional file 7
summary of test results by colonial assays. supplementary table 2

click here for file

 additional file 8
fold changes of the top  <dig> mutants sensitive to cincreasin treatment. supplementary figure 5

click here for file

 additional file 9
colonial assays for testing s.cerevisiae mutants in the presence of dmso  and cincreasin . supplementary figure 6

click here for file

 acknowledgements
ck is supported by the brain korea  <dig> project. sz is supported by stowers institute for medical research  and illinois regenerative medicine institute .
