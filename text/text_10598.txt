BACKGROUND
microarray platforms based on single nucleotide polymorphisms  are powerful tools in the research of genomic structural variation because they allow the integration of genotype and copy-number information. researchers can simultaneously identify both copy number and copy number neutral changes, using the log2-ratio  intensity signal and the allele genotyping of the probes  <cit> . while snp arrays have been effectively used in the study of copy number variation  and single nucleotide polymorphism  genotyping, only recently they have been utilised to identify the mosaic occurrence of copy number and copy neutral genomic abnormalities  <cit> . genetic mosaicism is recognized as the presence of two or more different cell populations with different genotypes in one single individual, developed from a single fertilized egg. such genetic abnormalities may result from a mutation during development that is propagated to only a subset of the adult cells. somatic mosaicism for chromosomal rearrangements has been recently described on the basis of comparative analysis of differentiated human tissues from adult individuals  <cit>  and divergence between identical twins  <cit> . moreover it is well known that some mosaic abnormalities are involved in multiple developmental and tissue-specific disorders  <cit> . despite of all these evidences, the frequency and extent of chromosomal mosaicism in adult normal population has been estimated only recently for the first time  <cit> , and its real contribution to intra- and inter-individual genome variation is yet to be determined. for helping in that purpose, specialized algorithms and data analysis tools aimed at calling the mosaic occurrence of structural variation are badly needed.

mosaic events can be captured by analysing snp array data, specially from assessing multiple clusters of heterozygous alleles showing b allele frequency  and lrr values different from the those expected for regular heterozygous deletions, duplications or loss of heterozygosis events . two recent studies have demonstrated that structural variants occurring in mosaicism are more frequent than expected, and thus they may play a relevant role in human diversity and disease susceptibility  <cit> . while both studies used illumina snp array data, only rodr√≠guez-santiago et al.  used tools for discovering occurrences in a systematic way. their approach may, however, result in the underestimation of mosaic prevalence in two challenging situations: 1) small rearrangements and 2) rearrangements affecting a low percentage of cells. in addition, the used algorithm was computationally demanding , which constitutes a technical drawback in the analysis of high-density arrays of thousands of individuals.

mosaicism detection can be cast as a segmentation problem  <cit> . in fact bafsegmentation is a software developed for the identification of mosaicism in cancer cells based on the circular binary segmentation  algorithm  <cit> . the disadvantage of this procedure is the lack of a method to clearly control the false discovery rate   <cit> .

as an alternative segmentation method, the genome alteration detection analysis  can also identify allelic imbalances by using baf values provided by snp arrays  <cit> . this value is the fraction of the total signal due to a specific allele and it is the suited value to study allelic imbalances underlying mosaicism for genomic rearrangements. compared to circular binary segmentation   <cit> , gada has similar accuracy, and is several orders of magnitude faster. recently, gada segmentation was applied to cnv calling by using lrr values from snp array data in very large data sets with high efficiency and accuracy  <cit> . to overcome the specific difficulties in the identification of mosaic events from snp arrays, we have developed mosaic alteration detection-mad method which includes both statistic  and bioinformatic tools to specifically analyse baf values from snp array data. the software presented here improves snp array data analysis allowing the capture of mosaic copy number  and copy neutral changes , as well as regions of homozygosity due to identity-by-descent. the developed method was used to analyse illumina humanhap 1m snp array data obtained from control, bladder cancer and hapmap individuals. we also compared its performance  with bafsegmentation  <cit>  under several simulated challenging scenarios like small altered regions, low percentage of mosaic cells and poor array quality. finally, our tool was applied to snp array data previously utilised for detecting mosaic abnormalities  <cit> . while all published findings were successfully identified, additional mosaic events were detected by mad and experimentally validated afterwards. our results suggest that improved methods can accurately capture mosaic chromosomal rearrangements using snp array data and that their prevalence is higher than initially thought.

RESULTS
method development
new mosaic rearrangements from previously utilised snp array datasets
hapmap individuals
to check how the algorithm works with real data mad tool was applied to data obtained from lymphoblastic cell line dna of  <dig> individuals from hapmap population  hybridized with illumina humanhap 1m snp array, available at public repositories http://www.hapmap.org. for mad, parameters were set to t =  <dig>  a =  <dig>   and the minimum probe length for detection at minseglen =  <dig>  meaning the algorithm is able to detect altered regions >  <dig>  mb for  <dig> mb arrays. furthermore, with a =  <dig>  finding few number of segments for each individual is expected. with these parameters, the fdr was <  <dig> . the tool identified  <dig> mosaic rearrangements in  <dig> individuals . mosaic uniparental disomy was observed for chromosome  <dig> in one individual . mosaic duplications were detected in three individuals affecting chromosome  <dig> , chromosome  <dig>  and chromosome  <dig> . gains of the entire chromosome compatible with mosaic trisomies were observed in  <dig> individuals  involving chromosomes  <dig>   <dig> and  <dig>   <dig> and  <dig>  respectively and different percentage of mosaic cells . in addition the performance of mad was compared to bafsegmentation using default parameters in the hapmap individuals analysed. compared to mad, bafsegmentation algorithm was unable to detect  <dig> alterations, trisomies with very low proportion of affected cells . the obtained results are consistent with the simulation analysis performed in the present work where bafsegmentation showed less sensitivity for low mosaic cell proportions .

the second column indicates whether bafsegmentation algorithms also found the alteration.

control and bladder cancer individuals
the tool was also used to re-analyse previously defined and validated mosaic rearrangements reported elsewhere  <cit> . a selected subset of  <dig> mosaic rearrangements among  <dig> samples was initially studied. parameters were set to t =  <dig>  a =  <dig>  and minseglen =  <dig> that are predicted to have a fdr of  <dig> .

using these settings the tool was able to detect all previously defined mosaic rearrangements but one . remarkably, the algorithm did not provide any false-positive calls. the false-negative result was a small deletion on chromosome  <dig> only comprised by  <dig> probes . nonetheless, this alteration was detected by changing minseglen to  <dig>  and no other abnormality was found in this sample by using this setting. overall, the predicted fdr using minseglen =  <dig> is  <dig> . the minseglen is a parameter that can be adjusted depending on probe coverage of the array, and it can be reduced for hihg-density arrays such as illumina humanhap 1m. the complete dataset of  <dig> samples was studied afterwards  <cit> . we set minseglen =  <dig> and t =  <dig>  to increase power detection at the expense of higher fdr . the algorithm detected  <dig> new segments not identified either with previous tools or with bafsegmentation . these abnormalities were smaller in size than those previously reported, with the minimum size of ~  <dig> kb  which represents an improvement in the detection of smaller events. we experimentally validated the mosaic abnormalities in all  <dig> available dna samples by multiple ligase-dependent probe amplification  . the algorithm also detected  <dig> duplication segments ranging in size from ~  <dig>  to ~  <dig> mb with average lrr <  <dig>  suggestive of possibly being mosaics .

the new abnormalities observed were smaller than those previously reported. figures are available in the additional file  <dig> - figures s <dig> to s <dig> 

 <dig> additional file  <dig>  shows the mlpa electropherograms and control comparisons.

simulation studies
several simulation studies were run to further assess the performance of mad and bafsegmentation analysis tools. specifically, eight scenarios were considered depending on i) the percentage of affected cells with the altered region: 10% and 20%; ii) the length of the alteration: small and large; and iii) the quality of data: good and noisy. the baf value was simulated for  <dig>  snps using a log-normal distribution with mean  <dig> for aa homozygous and mean  <dig> for bb homozygous probes. a normal distribution with mean  <dig>  was used to generate heterozygous markers. different quality data was generated varying the variance of these distributions . the percentage of cells with an abnormal region was simulated by changing the mean value for heterozygous probes . finally, abnormal large regions were generated by modifying  <dig>  markers, while small aberrant regions contained  <dig>  probes. these simulations allowed the calculation of: 1) the roc curve ; 2) the fdr; and 3) differences in sensitivities of mad and bafsegmentation. the results were based on  <dig>  simulations.

true-positive  and false-positive  rates
the performance of mad algorithm was examined under changes in the parameters, a ‚àà { <dig> ,  <dig> } and t ‚àà { <dig> ,  <dig>   <dig> ,  <dig>   <dig> , 5}, that control its sensitivity and specificity. figure  <dig> shows the roc curve  for different simulated scenarios and for the case of having moderate to large altered regions. as expected, the tpr improves when both quality data and percentage of affected cells increase. the performance was almost perfect  when quality data was good and the degree of mosaicism was at least 20% . similar results were obtained when analyzing simulated segments with less density .

false discovery rate 
as a significant feature mad incorporates a general method to control fdr. this method was validated by using simulated datasets and comparing estimated with expected fdr values. figure  <dig> shows the fdr comparison for different scenarios under a =  <dig> . a good agreement between simulated and estimated fdr in all situations was observed: the fdr decreased when either t , the percentage of affected cells or data quality increased. similar results were obtained for a =  <dig> , where the fdr is larger than the previous case, as expected.

comparison with bafsegmentation
the performance of mad and bafsegmentation tools was studied by simulating low cell proportion of mosaic alterations. a single segment of  <dig> probes within a dna chunk of 20-kb in length was simulated  <dig> times for different proportion of mosaic cells . parameters of both algorithms were fixed such as optimum specificity was achieved for both methods across the whole range. in other words, the algorithms were adjusted for not finding any segment which was completely disjointed from the one simulated. in particular, this was satisfied with a =  <dig> , t =  <dig> and minseglen =  <dig> for mad, and default values for bafsegmentation. the comparison was assessed using the sensitivity of each method by measuring the proportion of identified segments covering at least 50% of the simulated segment.

overall mad showed a better performance when compared to bafsegmentation as can be seen in figure  <dig>  bafsegmentation achieved good sensitivity in the range of mosaic cell proportions >  <dig> , and null sensitivity for values <  <dig> . on the other hand, despite the lower sensitivity of mad in the range , there is an important amount on sensitivity captured in low values  and a high sensitivity  at  <dig> . the overall performance of both methods can be compared from the areas under each curve. in the case of the mad curve the estimation of this area, normalized by the area of the perfect sensitivity curve , is  <dig> / <dig>  =  <dig> ; whereas for bafsegmentation this area is smaller . therefore, under this scenario, mad showed better sensitivity over the whole range of mosaic cell proportions. in addition, the computational time for analyzing the  <dig> samples described in previous sections was  <dig> min  <dig> sec when using mad, while bafsegmentation needed  <dig> min  <dig> sec.

CONCLUSIONS
the accurate and appropriate analysis of snp array data of genomic dna from multiple cells allows for the identification of genomic changes occurring in mosaicism and subsequently for the estimation of the affected cell proportion. the assessment of this increasingly recognised type of genetic variation is relevant to define its impact over human diversity and clinical phenotypes. in this study, we have implemented the so called mad tool to detect mosaic events from snp arrays using the baf value as a powerful parameter to detect the allelic imbalances that underlie mosaic alterations. our method was successful in finding previously defined mosaic chromosomal alterations, and able to detect additional events in the same data set  <cit> , which suggests a higher sensitivity for mad. remarkably, the tool was able to find mosaic rearrangements of smaller size  and events affecting a lower proportion of cells, uncalled when using other algorithms.

the easy manipulation of the parameters a and t offers flexibility to the optimization of mad for a wide range of circumstances. in contrast, a greater optimization of bafsegmentation has yet to be developed for truly assessing the performace of the method, especially for small and low proportion of cells affected another significant advantage of mad is that the fdr can be directly handled by performing setting changes in its parameters. high sensitivity and low fdr are essential in assessing the prevalence of mosaic events in the available datasets. we have shown how to estimate the fdr from the segmentation output and, in our simulation studies, how close is such estimate is very close to the expected one. however, it is important to note that fdr also depends on the window for minimum probe length . one possible limitation of our method is the increase in the number of false positives when reducing the  for analysing arrays with lower probe coverage.

an unexpectedly increased number of duplications with respect to deletions were called by mad. most of these calls were not treated as mosaic because their features  or their plots did not suggest mosaic occurrence . while the distinction between constitutional and mosaic events is quite evident for deletions and upds, due to the finding of complete loss of heterozygosity only in non-mosaic rearrangements, in the case of copy number gains  it is not so straightforward because the presence of heterozygous probes is expected. due to the technical limitations in array platforms the change in copy number from  <dig> to  <dig> or an intermediate number could be in the same sensitivity range thus providing lrr and baf array values similar for both normal gain dosage changes  and mosaic changes occurring in a subset of cells. a comparison between mad analysis and cnv calling process using penncnv and filtering procedures revealed that  <dig> mad duplications were absent in cnv dataset when a statistic filter was applied  <cit> . the  <dig> duplications showing any overlap in both datasets were 59% identical on average  . these results may suggest on one hand that mad software seems to be more effective in calling duplications than typical cnv calling procedures and, in the other hand, that some duplication calls observed using mad may be non mosaic alterations.

reanalysis of the previously assessed snp array data in  <cit>  demonstrates that there are hidden genomic mosaic events that cannot be detected by using ad-hoc routines. the fact that such genomic allelic imbalances can be smaller and present in a lower proportion of cells, emphasizes the need of improving and using more powerful analytical methods. however, an open question regarding the detection limit remains partially dependent on the array resolution given that no gold standard exists to define the false negative rate for most rearrangements . while we have shown that mad can successfully detect small and very low mosaicism degree events and that the prevalence of mosaicism can still be higher, further improvements are needed in the analysis and experimental techniques. mosaicism is an unexpected source of genetic variation that is still underexplored. the study of existing and future snp array datasets, as well as the application of similar algorithms for allelic imbalance detection to next-generation sequencing data, will provide new clues about the impact of such genetic variation over phenotypic differences in the common population as well as its influence on disease.

