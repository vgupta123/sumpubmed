BACKGROUND
the study of embryonic development of the fly drosophila melanogaster revealed many genes important to the development of other metazoans, including humans. knowing the precise localization and time of gene expression is crucial in the elucidation of these dynamic cellular mechanisms. the advent of microarray technology has led to the generation of data sets measuring transcription or gene expression levels over the complete embryonic development of the fly  <cit> . under the assumption that genes with similar expression patterns have similar properties, the concept of co-expressed genes can be used to generate hypotheses about function, pathways and role of proteins that can be taken to the laboratory for further investigation. this reasoning, guilt-by-association, firmly installed the use of clustering algorithms in the analysis of data from dna microarrays  <cit> , as a cluster of genes ideally represent functional modules. for example, proteins expressed from co-regulated gene sets have been shown to physically interact  <cit> .

time-course data collected during the cell-cycle, development and differentiation, or in response to external factors required novel methods to cope with the temporal dependencies inherent to gene expression time-courses and with data quality issues; see  <cit>  for a recent review, which identified mixture models to be preferable. hence, mixture models and model-based clustering found wide-spread use in gene expression time-course analysis  <cit> . the robustness of mixture models and their flexibility to capture dependencies in the data by use of splines  <cit>  or hidden markov models   <cit>  as component models are the main reasons for the success of this technique in gene expression analysis. while the performance of some methods is quite impressive, the dimensionality of typical data sets – ten-thousands of genes, less than twenty time-points – implies that apparent co-expression of genes can be observed due to chance and that, hence, the value of information transfer between co-regulated genes is limited.

semi-supervised learning and heterogeneous data
one way to strengthen the concept of co-expression for clustering algorithms is to augment the primary data, gene expression time-courses in our application, with secondary, external data in order to yield biologically more plausible solutions; recall that most clustering algorithms are only guaranteed to converge locally. the framework of choice which fits in nicely with the iterative knowledge acquisition process in biology is semi-supervised learning  <cit> , partly clustering  and partly classification ; sometimes this is also referred to as constrained clustering  <cit>  . one of the first applications in bioinformatics  <cit>  shows, that less than 2% labels can drastically improve clustering quality. on real data, high-quality labels which indicate whether, for example, two genes are part of the same functional module can be obtained from the literature. use of abundant annotations from the gene ontology   <cit>  that are often used to validate clusterings  <cit>  provide surprisingly little improvement, partly due to a mismatch between the semantics of go and similarity of expression. in this work we use a formulation proposed in  <cit>  that can be combined with mixture model estimation.

spatial expression patterns
another important aspect of gene expression, its precise localization, has been studied in great detail in the fly. while the prime motivation for these sensitive experiments was to understand the role of individual genes in organ development, we can incorporate the spatial expression patterns for the generation of functional hypotheses.

genes that share the same temporal-spatial expression patterns are more likely to form a functional module. if they are synchronously co-expressed in one tissue, or in multiple tissues we speak of syn-expression  <cit>  and take in particular the latter case as a strong sign of functional similarity. the spatial expression patterns can be determined with in situ experiments where an mrna-specific stain is produced by mrna-binding oligonucleotides and a suitable dye  <cit> . further processing, imaging and image analysis produces either 2d or 3d images of spatial patterns of gene expression; large-scale data sets are available for fly development and for other model organisms. even though drosophila embryos are morphologically simple, the image analysis is quite involved as in-situ images are taken of many different subjects with large fluctuations in shape. in addition, the staining intensity has higher, gene-specific error rates compared to dna microarrays.

prior work
tomancak et al.  <cit>  performed a large scale study of gene expression in the fly embryos by in situ rna hybridizations. the images were manually curated and annotated using a controlled vocabulary – imago – following the example of the gene ontology  <cit> . the final result was a hierarchical clustering of genes based on the manual annotations; the gene expression time-courses were not included in the analysis. further work concentrated on mining the image database for genes with a spatial expression pattern similar to a query  <cit>  and on the extraction of features deemed peculiar and noteworthy  <cit> , for example by clustering images based on an eigenvector based representation  <cit> . recent smaller scale studies investigated pattern formation in drosophila based on 3d in situ images  <cit>  for a small number of genes.

our contribution
we obtain clusters of syn-expressed genes during the development of drosophila. we propose to automatically infer positive constraints  and negative constraints  from the in situ image data and use them in a mixture model for the complementary, higher quality, dna microarray time-course data as shown in fig.  <dig> 

RESULTS
clustering of gene expression data using mixture of multivariate gaussians
we cluster gene expression data using a mixture of multivariate gaussians with diagonal covariance matrix and choose the number of components to be  <dig> as suggested by the bayesian information criterion  .

the gene expression time-courses cover the period from  <dig> to  <dig> hours of the embryo development and expression values are given as log-ratios . overall, our clustering results reflect two typical classes , the maternal and zygotic transcripts  <cit> . maternal genes appear strongly expressed in the first three hours, usually followed by a decline. the clusters  <dig> to  <dig> clearly follow a maternal pattern. these transcripts are deposited in the oocyte; typically the embryo does not transcribe these genes in early development. they are responsible for the determination of body axes and the first phases of the cell cycle and other functions. the period from  <dig> to  <dig> hours coincides with the cellularization and the formation of three germ layers following gastrulation, when primary tissues start to develop  <cit> . conversely, genes actively transcribed in the embryo are not expressed in the early time points and expression rises to significant levels only in later stages . many of these genes are important to organogenesis. transcripts in the clusters  <dig> to  <dig> and  <dig> to  <dig> follow the pattern of embryonic activation unambiguously. the functional association can be observed in the overrepresented gene ontology terms . for other clusters, shapes cannot be matched to such simple schemes. several have maximal expression in the midst of embryonic development. note that the clusters that show varying levels are less populated than the ones in the maternal and in the activated class.

using images as partial information
we use semi-supervised learning to obtain better solutions for the maximum-likelihood estimation by constraining the mixture estimation with pairwise constraints between genes. the principle behind this is shown in fig.  <dig>  we choose a very simple approach to compare the images, which gives competitive results compared to a computationally more complex previous approach  <cit> , combined with judicious filtering. the constraints are derived by measuring correlation between in situ images of pairs of genes. pairs of genes, whose images are highly correlated in three or more time periods, are positively constrained, see fig.  <dig> for example. negative constraints are derived similarly . these constraints will, ideally, differentiate between genes showing co-expression due to chance and causal temporal co-expression also supported by spatial co-expression .

as a previous study has shown  <cit> , noisy constraints will be detrimental to the clustering quality; consequently few high quality constraints are preferable compared to many constraints of medium or low quality. the correlation coefficients of all pairwise image comparisons showed a bi-modal distribution  which allowed to select the strongest correlations with little ambiguity. thus we arrived at a set of constraints derived from strongly positive and negative correlations.

changes in the biological annotations
to investigate the effects of the constraints in the clustering, we compare the results of the mixture of gaussians  against the mixture of gaussians with pairwise constraints  . as explained in section evaluation, we choose to use positive constraints, which are supported in at least three developmental stages, as they yield good recall of in situ image annotations.

as a sanity check, we inspect if cmog is successful in constraining the clustering by counting the number of constraints, as derived from the images, met in the final solutions. with mog, a sizeable proportion of the constraints are already satisfied , as the expression data partially agrees with the constraints as syn-expressed genes are co-expressed. with cmog,  <dig> out of  <dig> pairwise positive constraints are met, nearly twice the number for mog. this demonstrates that cmog benefits from the constraints in deriving the clusters.

another helpful analysis is the comparison of enrichment of in situ image annotations , as described in section evaluation . we display in fig.  <dig> a scatter plot with the p-values of all imago terms, which had an enrichment p-value below  <dig>  in one either cmog or mog clusters. in summary, cmog has a higher enrichment in  <dig> out of  <dig> relevant imago terms. a binomial test for testing the event of having  <dig> successes in  <dig> trials is rejected with a p-value of  <dig> , which indicates that the counts of imago terms with higher enrichment for cmog is significantly higher than expected by chance. furthermore, if we take only imago terms with a higher enrichment gain for one of the methods into account , the advantage of cmog is even greater . this indicates that even without direct use of the annotation information from imago, cmog has a greater sensitivity in grouping syn-expressed genes.

overall, the individual clusters of mog and cmog did not differ much; the cmog clusters were better spread and the number of clusters with few genes assigned is smaller. one way to quantify the distinctions is to calculate the sensitivity and specificity of cmog taking the results from mog as the ground truth. these values are respectively  <dig>  and  <dig> , which indicates that cmog has a tendency to subdivide clusters from mog.

functional annotations in constrained clusters
even for a well characterized genome like drosophila the high dimensionality in the annotation data provides only limited information for any single gene. analyzing the obtained clusters is also challenging due to the necessity to identify the corresponding functional modules in the unconstrained and the constrained sets and by the requirement to show improvements rather than simple correct functional assignments. in the following, we will refer to the ith cluster from cmog and mog as ci and ui respectively. for some cases, the mapping from clusters of cmog to mog is simply one to one . most other clusters show larger differences. we focus our functional analysis on clusters with zygoticly expressed transcripts .

cluster c <dig> represents a good example of the changes resulting from the introduction of constraints. it contains most of the genes from u <dig>  and  <dig> genes from u <dig>  out of the seven genes, which show similar expression patterns and have co-location constraints , only four  are found in the u <dig>  all these genes have imago annotations related to ventral nerve cord primordium and related terms . related genes that have no constraints but are annotated as part of the embryonic central nervous system are included in c <dig> . the analysis of go term enrichment indicates terms such as nervous system development  and system development  . it should be noted that the clusters u <dig> and u <dig> are similar overall and mainly differ in the average time when genes reach the plateau of maximal expression.

an example for larger changes is cluster c <dig>  which is mainly composed of genes originally found in u <dig>  and u <dig> . c <dig> was constrained by three genes  of which rhea and vig come from cluster u <dig> and rsf <dig> from u <dig> . this cluster presents smaller p-values for imago terms related to muscle primordium  than u <dig> and u <dig>  furthermore, go term analysis reveals that this cluster shows enrichment for nervous system development  and axis specification . for the latter term, seven genes are originally from u <dig>  and five from u <dig> , demonstrating that the changes introduced increased the number of syn-expressed genes within c <dig> 

the cluster c <dig> represents only a subset of u <dig>  but has no genes with constraints. it consists of genes from u <dig> that are not constrained to genes from c <dig> . still, it is enriched in the imago term embryonic central nervous system and related terms . the cluster is also enriched in the terms organ  and ectoderm development , which were significantly enriched in u <dig>  in other words, this cluster is a specialization of u <dig>  whose genes are specific to organ development.

c <dig> is formed by the addition of most genes in the u <dig> cluster  to u <dig> . there are seven genes constraining this cluster  . imago term enrichment relates this cluster to yolk nuclei and amnioserosa. it is also in enriched in the go term nervous system development , all of which were insignificant in the u <dig> cluster.

it is also worthwhile to look at those few cases where mog performed better. from fig.  <dig>  two imago terms with higher enrichment increase in mog are maternal and procephalic ectoderm anlage in statu nascendi. the first term was enriched in cluster c <dig> and u <dig>  where mog had some more genes related to the term maternal . for the latter imago term, clusters u <dig> and c <dig> were both enriched, and there was only one annotated gene in u <dig> not in c <dig>  as none of these annotated groups of genes had pairwise constraints, we could not detect any direct effect of the constrained clustering on these results.

the refined clusters improve the generation of testable hypotheses for the role of uncharacterized genes. overall, we observe improvement in annotation of genes related to development of the fly, in particular with respect to the imago annotations, which increases our confidence in the delineation of syn-expressed functional modules.

CONCLUSIONS
the generation of functional hypotheses by integrating different information sources is a key problem posed by the massive amounts of high-throughput data that is generated in todays laboratories. often, analyses are limited to few information sources and the integration only starts after many processing steps, frequently including manual annotation, and is more often than not performed manually.

here we have shown, for a limited setting, how to automatically fuse temporal and spatial gene expression patterns by semi-supervised clustering. our results show that the clusters we find are biologically meaningful and that we can detect clusters of syn-expressed genes which are worthwhile targets for further investigation, either with classical biological analysis or as the input for methods inferring networks. our implementation is reasonably simple and computationally efficient and the semi-supervised approach provides a flexible framework for adapting results to questions biologists are interested in. the main advantage of the semi-supervised approach over joint models and other approaches is that it can cope easily with the variations in data abundance from different sources. gene expression measured with dna microarrays is often available for ten-thousands of genes and many time-points, in situ hybridization will typically only cover a fraction of those, as will high quality protein interaction or protein structure data. our results show a small but very clear improvement, despite the complexity of the problem, namely the restriction to embryonic stages to few data points, and the usual caveats concerning dna microarrays and in situ images of gene expression. the open questions are manifold and concern both the biology and the computer science. how can we refine biological questions to yield more meaningful answers? how can one mine image data effectively, and does a representation in 2d suffice or is using the third dimension a necessity? the best combination of several, potentially conflicting, information sources to arrive at one set of constraints is an equally challenging problem. can one incorporate the per-stage constraints into the learning for time-course data? we have demonstrated that our methodology is a promising candidate for the delineation of functional modules using different data types and our results show that further investigations are likely to bear fruit.

